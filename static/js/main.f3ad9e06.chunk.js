(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(6),s=a(5),i=a(62),o=function(){function e(){Object(n.a)(this,e)}return Object(s.a)(e,null,[{key:"setSteem",value:function(t){e.steem=t,setTimeout(e.updateConfig,3e3),e.update=setInterval(e.updateConfig,6e5)}},{key:"getConfig",value:function(){return window.localStorage.removeItem("c"),Object.assign({},e.DEFAULT,e.config)}},{key:"updateConfig",value:function(){e.steem&&e.steem.getConfig().then(function(t){e.config=t,console.log("Configuration updated")}).catch(function(e){console.log(e)})}},{key:"getAppVersion",value:function(){return"".concat(i.name,"/").concat(i.version)}}]),e}();o.DEFAULT=i[i.name],o.steem=null,o.config=null,o.update=null},189:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return d});var n=a(6),s=a(10),i=a(7),o=a(5),r=a(11),l=a(2),c=a(38),u=a(17),d=function(t){function a(){var e;return Object(n.a)(this,a),(e=Object(s.a)(this,Object(i.a)(a).call(this))).localMode=!1,e.selectedNode=a.defaultNode,e.currentNode=a.defaultNode,e.localNodeCheckerInterval=null,e.firstCheck=!0,setTimeout(e.localNodeChecker.bind(Object(l.a)(Object(l.a)(e))),6e3),e.localNodeCheckerInterval=setInterval(e.localNodeChecker.bind(Object(l.a)(Object(l.a)(e))),3e4),e}return Object(r.a)(a,t),Object(o.a)(a,null,[{key:"getNodeUrl",value:function(e){return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/ipfs/"}}]),Object(o.a)(a,[{key:"getCurrentNode",value:function(){return this.currentNode}},{key:"getPublicNode",value:function(){return this.selectedNode}},{key:"getUrl",value:function(e,t){return(this.localMode?a.getNodeUrl(a.localGateway):a.getNodeUrl(t||this.currentNode))+e}},{key:"getExternalUrl",value:function(e,t){return a.getNodeUrl(t||this.selectedNode)+e}},{key:"connectApi",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.localMode?this.currentNode=a.localAPI:this.currentNode=this.selectedNode,this.ipfs=window.IpfsApi(this.currentNode)}},{key:"localNodeChecker",value:function(){var e=this;this.ipfs=window.IpfsApi(a.localAPI),this.ipfs.repo.stat().then(function(t){!e.firstCheck&&e.localMode||(e.localMode=!0,e.currentNode=a.localAPI,e.fireEvent("online",e.currentNode),console.log("local IPFS connected")),e.firstCheck=!1}).catch(function(t){(e.firstCheck||e.localMode)&&(e.localMode=!1,e.currentNode=e.selectedNode,e.fireEvent("offline",e.currentNode),console.log("local IPFS disconneted"),e.checkNodes(u.a.getConfig().ipfs.nodes).then(function(t){console.log("Selecting node:",t.host,"("+t.latency+"ms)"),e.selectedNode=e.currentNode=t}),e.firstCheck=!1)})}},{key:"checkNodes",value:function(e){return new Promise(function(t,n){return Promise.all(e.map(function(e){var t=new Date,n=a.getNodeUrl(e)+"Qmaisz6NMhDB51cCvNWa1GMS7LU1pAxdF4Ld6Ft9kZEP2a";return new Promise(function(e,a){var s=!1,i=setTimeout(function(){s=!0,e(999999)},1e4);fetch(n).then(function(e){return e.text()}).then(function(a){if(!s){clearTimeout(i);var n=a.trim()==="Hello from IPFS Gateway Checker".trim(),o=new Date;e(n?o-t:999999)}}).catch(function(t){console.log(t),e(999999)})})})).then(function(a){for(var n=e[0],s=999999,i=0;i<a.length;i++)e[i].latency=a[i],a[i]<s&&(s=a[i],n=e[i]);t(n)})})}},{key:"pinIfWeCan",value:function(e){this.localMode&&(this.connectApi(!0),this.ipfs.pin.add(e))}},{key:"getLocalStatus",value:function(){return this.localMode?(this.connectApi(!0),this.ipfs.repo.stat()):Promise.reject()}},{key:"fileAdd",value:function(t){this.connectApi();var a=e.from(t);return this.ipfs.files.add(a)}}]),a}(c.a);d.localGateway={host:"127.0.0.1",port:"8080",protocol:"http"},d.localAPI={host:"127.0.0.1",port:"5001",protocol:"http"},d.defaultNode=u.a.DEFAULT.ipfs.nodes[0]}).call(this,a(19).Buffer)},193:function(e,t,a){e.exports=a(459)},248:function(e,t){},257:function(e,t){},259:function(e,t){},275:function(e,t){},29:function(e,t,a){e.exports=a.p+"static/media/load.6068d1f9.gif"},30:function(e,t,a){e.exports=a.p+"static/media/doe.59c11314.png"},38:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(6),s=a(5),i=function(){function e(){Object(n.a)(this,e),this.handlers=null}return Object(s.a)(e,[{key:"on",value:function(e,t){var a=this;this.handlers||(this.handlers={});var n=this.handlers[e];return n||(n=this.handlers[e]=[]),n.push(t),{name:e,callback:t,un:function(e,t){return a.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var a,n=this.handlers[e];if(n)if(t)for(a=n.length-1;a>=0;a--)n[a]===t&&n.splice(a,1);else n.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var a=this;return this.on(e,function n(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];t.apply(a,i),setTimeout(function(){a.un(e,n)},0)})}},{key:"fireEvent",value:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];if(this.handlers){var s=this.handlers[e];s&&s.forEach(function(e){e.apply(void 0,a)})}}}]),e}()},408:function(e,t){},433:function(e,t){},434:function(e,t){},435:function(e,t){},450:function(e,t){},459:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"ajax",function(){return ae}),a.d(n,"getId",function(){return ne}),a.d(n,"max",function(){return se}),a.d(n,"min",function(){return ie}),a.d(n,"Observer",function(){return te.a}),a.d(n,"extend",function(){return oe}),a.d(n,"style",function(){return re}),a.d(n,"requestAnimationFrame",function(){return le}),a.d(n,"frame",function(){return ce}),a.d(n,"xss",function(){return fe}),a.d(n,"formatter",function(){return _}),a.d(n,"download",function(){return ge}),a.d(n,"debounce",function(){return ye.a});var s=a(0),i=a.n(s),o=a(21),r=a.n(o),l=a(478),c=a(479),u=a(460),d=a(6),h=a(5),m=a(10),p=a(7),f=a(11),g=a(477),v=a(4),y=a(2),b=a(474),k=a(461),E=a(462),w=a(463),N=a(464),S=a(339),O=a(480),C=a(465),j=a(466),P=a(467),x=a(468),F=a(469),D=a(470),T=a(471),A=a(472),U=a(473),L=a(14),R=(a(209),a(106)),I=a.n(R),_=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"number",value:function(t){for(var a=0;a<e.numberRanges.length;a++)if(t>=e.numberRanges[a].divider)return(t/e.numberRanges[a].divider).toFixed(1).toString()+e.numberRanges[a].suffix;return t.toString()}},{key:"data",value:function(t){for(var a=0;a<e.dataRanges.length;a++)if(t>=e.dataRanges[a].divider)return(t/e.dataRanges[a].divider).toFixed(1).toString()+e.dataRanges[a].suffix;return t.toString()}},{key:"sbd",value:function(e,t,a,n){t=t||2,a=a||".",n=n||",";var s=(e="string"===typeof e?e.split(" ")[0]:e)<0?"-":"",i=String(parseInt(e=Math.abs(Number(e)||0).toFixed(t),10)),o=i.length;return s+((o=o>3?o%3:0)?i.substr(0,o)+n:"")+i.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?a+Math.abs(e-i).toFixed(t).slice(2):"")}},{key:"dateFromNow",value:function(e){return I()(e+"Z").fromNow()}},{key:"time",value:function(e){return isNaN(e)?"0:00":I()("2015-01-01").startOf("day").seconds(e).format("H:mm:ss").replace(/^0:[0]{0,1}/,"")}}]),e}();_.numberRanges=[{divider:1e18,suffix:"Qi"},{divider:1e15,suffix:"Qa"},{divider:1e12,suffix:"T"},{divider:1e9,suffix:"B"},{divider:1e6,suffix:"M"},{divider:1e3,suffix:"K"}],_.dataRanges=[{divider:1e18,suffix:"P"},{divider:1e15,suffix:"E"},{divider:1e12,suffix:"T"},{divider:1e9,suffix:"G"},{divider:1e6,suffix:"M"},{divider:1e3,suffix:"K"}];var M=a(18),B=a.n(M),W=a(17),z=function(){function e(t,a){Object(d.a)(this,e),this.auth=t,this.ipfs=a;var n=W.a.getConfig();B.a.api.setOptions({url:n.chain.nodes[0]})}return Object(h.a)(e,[{key:"getConfig",value:function(){var e=W.a.getConfig();return new Promise(function(t,a){B.a.api.getAccounts([e.accounts.main],function(n,s){if(n)a(n);else if(s.length>0){var i=s[0],o=i.json_metadata?JSON.parse(i.json_metadata):null;o&&o[e.root]?t(o[e.root]):a(new Error("Invalid configuration from blockchain"))}else a(new Error("Couldn't load DSound configuration from blockchain"))})})}},{key:"getUserMetadata",value:function(e){return new Promise(function(t,a){B.a.api.getAccounts([e],function(e,n){if(e)a(e);else if(n.length>0){var s=n[0],i={};try{i=s.json_metadata?JSON.parse(s.json_metadata):{profile:{}}}catch(o){i={profile:{}}}i.profile||(i.profile={}),s.profile=i.profile,t(s)}else a(new Error("User not found on Steem blockchain"))})})}},{key:"getUserFollowing",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(a,n){B.a.api.getFollowing(e,t,"blog",100,function(e,t){e?n(e):a(t)})})}},{key:"getAllUserFollowing",value:function(e){var t=this;return new Promise(function(a,n){!function e(s){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=i.length?i[i.length-1].following:void 0;t.getUserFollowing(s,o).then(function(t){var n=i.concat(t);100===t.length?e(s,n):a(n)}).catch(n)}(e)})}},{key:"getUserFollowers",value:function(e,t){return new Promise(function(a,n){B.a.api.getFollowers(e,t,"blog",100,function(e,t){e?n(e):a(t)})})}},{key:"getAllUserFollowers",value:function(e){var t=this;return new Promise(function(a,n){!function e(s){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=i.length?i[i.length-1].follower:void 0;t.getUserFollowers(s,o).then(function(t){var n=i.concat(t);100===t.length?e(s,n):a(n)}).catch(n)}(e)})}},{key:"getUserFollowCount",value:function(e){return new Promise(function(t,a){B.a.api.getFollowCount(e,function(e,n){e?a(e):t(n)})})}},{key:"followUser",value:function(e){var t=this;return new Promise(function(a,n){var s=t.auth.getAuthUser(),i=JSON.stringify(["follow",{follower:s.name,following:e,what:["blog"]}]);B.a.broadcast.customJson(t.auth.getAuthWif(),[],[s.name],"follow",i,function(e,t){e?n(e):a(t)})})}},{key:"unfollowUser",value:function(e){var t=this;return new Promise(function(a,n){var s=t.auth.getAuthUser(),i=JSON.stringify(["follow",{follower:s.name,following:e,what:[]}]);B.a.broadcast.customJson(t.auth.getAuthWif(),[],[s.name],"follow",i,function(e,t){e?n(e):a(t)})})}},{key:"postComment",value:function(t,a){var n=this;return new Promise(function(s,i){var o=n.auth.getAuthUser(),r="re-"+t.permlink+"-"+(new Date).toISOString().replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();B.a.broadcast.comment(n.auth.getAuthWif(),t.author,t.permlink,o.name,r,"Re: "+t.title,a,{tags:[t.category],app:e.AppVersion},function(e,t){e?i(e):s(t)})})}},{key:"countVotes",value:function(e){return e&&e.active_votes&&0!==e.active_votes.length?e.active_votes.reduce(function(e,t){return t.percent>0?e+1:e},0):0}},{key:"countDownVotes",value:function(e){return e&&e.active_votes&&0!==e.active_votes.length?e.active_votes.reduce(function(e,t){return t.percent<0?e+1:e},0):0}},{key:"processMetadata",value:function(t){var a=t;return a.json_metadata&&a.json_metadata.length>0?a.metadata=JSON.parse(a.json_metadata):a.metadata={},a.id||(a.id=a.post_id||e.idFailover++),a.upvotes=this.countVotes(t),a.downvotes=this.countDownVotes(t),a}},{key:"getSoundsFeed",value:function(t){var a=this;return new Promise(function(n,s){var i,o,r=a.auth.getAuthUser();r?(i={tag:r.name,limit:e.PageItems},o="getDiscussionsByFeed"):(i={tag:e.CommunityTag,limit:e.PageItems},o="getDiscussionsByTrending");var l=[];!function t(r){r&&(i.start_author=r.author,i.start_permlink=r.permlink,i.limit++),B.a.api[o](i,function(i,o){if(i)s(i);else{r&&o.shift();var c=o.filter(function(e){return e.net_rshares>=0}).map(function(e){return a.processMetadata(e)});(l=l.concat(c.filter(function(e){return void 0!==e.metadata.audio}))).length<e.PageItems&&o.length?t(o[o.length-1]):n(l)}})}(t)})}},{key:"getSoundsTrending",value:function(t,a){var n=this;return new Promise(function(s,i){var o=e.CommunityTag;t&&(o=e.TagPrefix+t);var r={tag:o,limit:e.PageItems},l=[];!function t(a){a&&(r.start_author=a.author,r.start_permlink=a.permlink,r.limit++),B.a.api.getDiscussionsByTrending(r,function(o,r){if(o)i(o);else{a&&r.shift();var c=r.filter(function(e){return e.net_rshares>=0}).map(function(e){return n.processMetadata(e)});(l=l.concat(c.filter(function(e){return void 0!==e.metadata.audio}))).length<e.PageItems&&r.length?t(r[r.length-1]):s(l)}})}(a)})}},{key:"getSoundsHot",value:function(t,a){var n=this;return new Promise(function(s,i){var o=e.CommunityTag;t&&(o=e.TagPrefix+t);var r={tag:o,limit:e.PageItems},l=[];!function t(a){a&&(r.start_author=a.author,r.start_permlink=a.permlink,r.limit++),B.a.api.getDiscussionsByHot(r,function(o,r){if(o)i(o);else{a&&r.shift();var c=r.filter(function(e){return e.net_rshares>=0}).map(function(e){return n.processMetadata(e)});(l=l.concat(c.filter(function(e){return void 0!==e.metadata.audio}))).length<e.PageItems&&r.length?t(r[r.length-1]):s(l)}})}(a)})}},{key:"getSoundsNew",value:function(t,a){var n=this;return new Promise(function(s,i){var o=e.CommunityTag;t&&(o=e.TagPrefix+t);var r={tag:o,limit:e.PageItems},l=[];!function t(a){a&&(r.start_author=a.author,r.start_permlink=a.permlink,r.limit++),B.a.api.getDiscussionsByCreated(r,function(o,r){if(o)i(o);else{a&&r.shift();var c=r.filter(function(e){return e.net_rshares>=0}).map(function(e){return n.processMetadata(e)});(l=l.concat(c.filter(function(e){return void 0!==e.metadata.audio}))).length<e.PageItems&&r.length?t(r[r.length-1]):s(l)}})}(a)})}},{key:"getSoundsForUser",value:function(t,a){var n=this,s=W.a.getConfig();return new Promise(function(i,o){var r={tag:t,limit:100};a&&(r.start_author=a.author,r.start_permlink=a.permlink),B.a.api.getDiscussionsByBlog(r,function(t,r){if(t)o(t);else{a&&r.shift();var l=r.filter(function(e){return e.net_rshares>=0}).map(function(e){return n.processMetadata(e)}).filter(function(e){return void 0!==e.metadata.audio}).filter(function(t){return t.category===e.MainTag||t.category.startsWith(s.community.prefix)});i(l)}})})}},{key:"getSoundData",value:function(e,t){var a=this;return new Promise(function(n,s){B.a.api.getContent(e,t,function(e,t){e?s(e):(t=a.processMetadata(t),n(t))})})}},{key:"getSoundComments",value:function(e,t){return new Promise(function(a,n){B.a.api.getContentReplies(e,t,function(e,t){e?n(e):a(t)})})}},{key:"getCommentData",value:function(e,t){return this.getSoundData(e,t)}},{key:"voteSound",value:function(e,t){var a=this,n=this.auth.getAuthUser();return new Promise(function(s,i){B.a.broadcast.vote(a.auth.getAuthWif(),n.name,e.author,e.permlink,t?1e4:0,function(e,t){e?i(e):s(t)})})}},{key:"repostSound",value:function(e){var t=this,a=this.auth.getAuthUser();return new Promise(function(n,s){var i=JSON.stringify(["reblog",{account:a.name,author:e.author,permlink:e.permlink}]);B.a.broadcast.customJson(t.auth.getAuthWif(),[],[a.name],"follow",i,function(e,t){e?s(e):n(t)})})}},{key:"flagSound",value:function(e,t){var a=this,n=this.auth.getAuthUser();return new Promise(function(s,i){B.a.broadcast.vote(a.auth.getAuthWif(),n.name,e.author,e.permlink,t?-1e4:0,function(e,t){e?i(e):s(t)})})}},{key:"generatePermlink",value:function(e){return(new Date).toISOString().replace(/[^a-zA-Z0-9]+/g,"").toLowerCase()+"-"+e.title.toLowerCase().replace(/[-. ]+/g," ").replace(/[^a-z0-9 ]/g,"").trim().replace(/\s/g,"-")}},{key:"generateCommentPermlink",value:function(e){var t=(new Date).toISOString().replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();return"re-"+e.title.toLowerCase().replace(/[-. ]+/g," ").replace(/[^a-z0-9 ]/g,"").trim().replace(/\s/g,"-")+"-"+t}},{key:"computeTags",value:function(t){var a=[];(a.push(e.MainTag),["original","cover","remix","mashup","live","demo","djset"].includes(t.type)?a.push("music"):a.push(t.type),a.push(e.TagPrefix+t.type),a.push(e.TagPrefix+t.genre),t.tags&&t.tags.length>0)&&t.tags.split(", ").map(function(e){return a.includes(e)||a.push(e),null});return a.slice(0,10)}},{key:"computeMetadata",value:function(t,a){var n=this.computeTags(t),s=Object(v.a)({},t,{files:a});return JSON.stringify({audio:s,tags:n,app:e.AppVersion})}},{key:"computeBody",value:function(e,t,a,n){var s=W.a.getConfig(),i=this.ipfs.getExternalUrl(t.sound),o=null;t.cover&&t.cover.length>0&&(o=this.ipfs.getExternalUrl(t.cover));var r=o?'<center><a href="'.concat(s.link,"/@").concat(a.name,"/").concat(n,'"><img src="').concat(o,'" width="400px"></a></center>\n<hr>\n\n'):"";return"".concat(r).concat(e.desc,'<hr>\n      <a href="').concat(s.link,"/@").concat(a.name,"/").concat(n,'">\u25ba Listen on DSound</a><br>\n      <a href="').concat(i,'">\u25ba Listen from source (IPFS)</a>')}},{key:"publishSound",value:function(t,a){var n,s=this,i=W.a.getConfig();if(t.where.startsWith(i.community.prefix))n=[{account:i.accounts.team,weight:i.fees.team},{account:t.where,weight:i.fees.hive}];else{if(t.where!==e.MainTag)return Promise.reject(new Error("Invalid post destination"));n=[{account:i.accounts.team,weight:i.fees.team}]}return new Promise(function(e,i){var o=s.auth.getAuthUser();if(!o)return i(new Error("No user logged-in"));var r=s.generatePermlink(t),l=s.computeMetadata(t,a),c=s.computeBody(t,a,o,r),u=[["comment",{parent_author:"",parent_permlink:t.where,author:o.name,permlink:r,title:t.title,body:c,json_metadata:l}],["comment_options",{author:o.name,permlink:r,max_accepted_payout:"1000000.000 SBD",percent_steem_dollars:1e4,allow_votes:!0,allow_curation_rewards:!0,extensions:[[0,{beneficiaries:n}]]}]];B.a.broadcast.send({operations:u,extensions:[]},{posting:s.auth.getAuthWif()},function(t){t?(console.error(t),i(t)):e()})})}},{key:"updateSound",value:function(e,t,a){var n=this;return new Promise(function(s,i){var o=n.auth.getAuthUser();if(!o)return i(new Error("No user logged-in"));var r=n.computeMetadata(t,a),l=n.computeBody(t,a,o,e.permlink),c=[["comment",{parent_author:"",parent_permlink:e.parent_permlink,author:e.author,permlink:e.permlink,title:t.title,body:l,json_metadata:r}],["comment_options",{author:e.author,permlink:e.permlink,max_accepted_payout:"1000000.000 SBD",percent_steem_dollars:1e4,allow_votes:!0,allow_curation_rewards:!0,extensions:[]}]];B.a.broadcast.send({operations:c,extensions:[]},{posting:n.auth.getAuthWif()},function(e){e?(console.error(e),i(e)):s()})})}}]),e}();z.AppVersion=W.a.getAppVersion(),z.MainTag=W.a.DEFAULT.tags.main,z.CommunityTag=W.a.DEFAULT.community.hive,z.TagPrefix=W.a.DEFAULT.tags.prefix,z.PageItems=10,z.idFailover=0;var V=a(30),G=a.n(V),q=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.steem=a.props.steem,a.playlist=a.props.playlist;var n=a.auth.getAuthUser(),s=a.auth.getAuthUserList();return n&&(n.profile={profile_image:"",name:""}),a.state={activeUser:n,usersLoggedIn:s,login:{user:"",pkey:""},validation:{user:!1,pkey:!1},ipfs:null,dropdownOpen:!1,ipfsOpen:!1,loginOpen:!1},a.toggle=a.toggle.bind(Object(y.a)(Object(y.a)(a))),a.gotoProfile=a.gotoProfile.bind(Object(y.a)(Object(y.a)(a))),a.gotoWallet=a.gotoWallet.bind(Object(y.a)(Object(y.a)(a))),a.toggleLogin=a.toggleLogin.bind(Object(y.a)(Object(y.a)(a))),a.toggleIpfsSettings=a.toggleIpfsSettings.bind(Object(y.a)(Object(y.a)(a))),a.onChangeLoginUser=a.onChangeLoginUser.bind(Object(y.a)(Object(y.a)(a))),a.onBlurLoginUser=a.onBlurLoginUser.bind(Object(y.a)(Object(y.a)(a))),a.onChangeLoginPkey=a.onChangeLoginPkey.bind(Object(y.a)(Object(y.a)(a))),a.onBlurLoginPkey=a.onBlurLoginPkey.bind(Object(y.a)(Object(y.a)(a))),a.updateLoggedInUserData=a.updateLoggedInUserData.bind(Object(y.a)(Object(y.a)(a))),a.doLogin=a.doLogin.bind(Object(y.a)(Object(y.a)(a))),a.doLogout=a.doLogout.bind(Object(y.a)(Object(y.a)(a))),a.doSelectAccount=a.doSelectAccount.bind(Object(y.a)(Object(y.a)(a))),a.gotoUpload=a.gotoUpload.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"sidebarToggle",value:function(e){e.preventDefault(),document.body.classList.toggle("sidebar-hidden")}},{key:"sidebarMinimize",value:function(e){e.preventDefault(),document.body.classList.toggle("sidebar-minimized")}},{key:"mobileSidebarToggle",value:function(e){e.preventDefault(),document.body.classList.toggle("sidebar-mobile-show")}},{key:"openInNewTab",value:function(e){window.open(e,"_blank").focus()}},{key:"gotoProfile",value:function(e){this.openInNewTab("".concat(e.chain.website,"/@").concat(this.state.activeUser.name))}},{key:"gotoWallet",value:function(e){this.openInNewTab("".concat(e.chain.wallet,"/@").concat(this.state.activeUser.name,"/transfers"))}},{key:"toggleLogin",value:function(){this.setState({loginOpen:!this.state.loginOpen})}},{key:"toggleIpfsSettings",value:function(){var e=this;this.playlist.getLocalIpfsStatus().then(function(t){e.setState({ipfs:t})}).catch(function(t){e.setState({ipfs:null})}),this.setState({ipfsOpen:!this.state.ipfsOpen})}},{key:"onChangeLoginUser",value:function(e){var t,a=e.target.value;t=/^[a-zA-Z][a-zA-Z0-9-]{2,}(\.[a-zA-Z0-9-]{3,})*$/.test(a),this.setState({login:Object(v.a)({},this.state.login,{user:a}),validation:Object(v.a)({},this.state.validation,{user:t})})}},{key:"onBlurLoginUser",value:function(e){var t,a=e.target.value;a=a.replace(/[^a-zA-Z0-9.-]/g,""),t=/^[a-zA-Z][a-zA-Z0-9-]{2,}(\.[a-zA-Z0-9-]{3,})*$/.test(a),this.setState({login:Object(v.a)({},this.state.login,{user:a}),validation:Object(v.a)({},this.state.validation,{user:t})})}},{key:"onChangeLoginPkey",value:function(e){var t,a=e.target.value;t=/^[0-9][a-zA-Z0-9]{49,}$/.test(a),this.setState({login:Object(v.a)({},this.state.login,{pkey:e.target.value}),validation:Object(v.a)({},this.state.validation,{pkey:t})})}},{key:"onBlurLoginPkey",value:function(e){var t,a=e.target.value;a=a.replace(/[^a-zA-Z0-9]/g,""),t=/^[0-9][a-zA-Z0-9]{49,}$/.test(a),this.setState({login:Object(v.a)({},this.state.login,{pkey:e.target.value}),validation:Object(v.a)({},this.state.validation,{pkey:t})})}},{key:"updateLoggedInUserData",value:function(){var e=this,t=this.auth.getAuthUser(),a=this.auth.getAuthUserList();if(t){var n=a.map(function(n){return e.steem.getUserMetadata(n.name).then(function(e){return e.id===t.id&&(t.profile=e.profile),a.find(function(t){return t.id===e.id}).profile=e.profile,e}).catch(function(e){console.log("error retrieving user metadata:",e)})});Promise.all(n).then(function(n){e.setState({activeUser:t,usersLoggedIn:a})})}else this.setState({activeUser:t,usersLoggedIn:a})}},{key:"doLogin",value:function(){var e,t=this,a=this.state.login.user.trim(),n=this.state.login.pkey.trim();a&&n&&(this.toggleLogin(),void 0===this.state.usersLoggedIn.find(function(e){return e.name===a})?this.auth.authenticate(a,n).then(function(a){return e=a,t.steem.getUserMetadata(e.name)}).then(function(a){e.profile=a.profile,t.setState({activeUser:e}),setTimeout(function(){t.updateLoggedInUserData(),L.toast.info("Login successful!")},0)}).catch(function(e){L.toast.error(e.message)}):L.toast.error("User already logged-in"))}},{key:"doLogout",value:function(){var e=this.state.activeUser;e?(this.auth.logout(),this.updateLoggedInUserData(),L.toast.info("@"+e.name+" logged-out")):L.toast.error("Not logged-in")}},{key:"doSelectAccount",value:function(e){this.state.activeUser.id!==e.id?(this.auth.selectUser(e.id),this.updateLoggedInUserData(),L.toast.info("@"+e.name+" selected")):L.toast.error("Already the selected user")}},{key:"gotoUpload",value:function(){this.props.history.push("/upload")}},{key:"componentWillMount",value:function(){this.updateLoggedInUserData()}},{key:"loggedIn",value:function(e){var t=this,a=W.a.getConfig(),n=this.state.activeUser,s=n.profile.profile_image;s||(s=G.a);var o=this.state.usersLoggedIn.map(function(e){return e.id===n.id?i.a.createElement(k.a,{key:e.id},i.a.createElement("i",{className:"fa fa-user"})," @",e.name):i.a.createElement(k.a,{key:e.id,onClick:function(){return t.doSelectAccount(e)}},i.a.createElement("i",{className:"fa fa-user"})," @",e.name)});return i.a.createElement("ul",{className:"nav navbar-nav ml-auto"},i.a.createElement("li",{className:"nav-item d-lg-none px-3"},i.a.createElement("button",{onClick:this.gotoUpload,className:window.location.href.endsWith("hot")?"nav-link active":"nav-link"},i.a.createElement("i",{className:"fa fa-cloud-upload fa-lg"}))),i.a.createElement("li",{className:"nav-item d-md-down-none px-3"},i.a.createElement("button",{onClick:this.gotoUpload,className:window.location.href.endsWith("upload")?"nav-link active":"nav-link"},i.a.createElement("i",{className:"fa fa-cloud-upload fa-lg"})," Upload")),i.a.createElement("li",{className:"nav-item"},i.a.createElement(E.a,{isOpen:this.state.dropdownOpen,toggle:this.toggle},i.a.createElement(w.a,{tag:"button",className:"nav-link dropdown-toggle","aria-haspopup":!0,"aria-expanded":this.state.dropdownOpen},i.a.createElement("img",{src:s,className:"img-avatar",alt:""}),i.a.createElement("span",{className:"d-md-down-none"},"@",n.name)),i.a.createElement(N.a,{right:!0},i.a.createElement(k.a,{header:!0,className:"text-center"},i.a.createElement("strong",null,n.profile.name||n.name)),i.a.createElement(k.a,{onClick:function(){return t.props.history.push("/@"+t.state.activeUser.name)}},i.a.createElement("i",{className:"fa fa-play-circle-o"})," My Sounds"),i.a.createElement(k.a,{onClick:function(){return t.gotoProfile(a)}},i.a.createElement("i",{className:"fa fa-user"})," ","Profile on ".concat(a.chain.name)),i.a.createElement(k.a,{onClick:function(){return t.gotoWallet(a)}},i.a.createElement("i",{className:"fa fa-usd"})," ","Wallet on ".concat(a.chain.name)),i.a.createElement(k.a,{header:!0,className:"text-center"},i.a.createElement("strong",null,"Accounts")),o,i.a.createElement(k.a,{onClick:this.toggleLogin},i.a.createElement("i",{className:"fa fa-plus"})," Add another"),i.a.createElement(k.a,{onClick:this.doLogout},i.a.createElement("i",{className:"fa fa-lock"})," Logout @",n.name),i.a.createElement(k.a,{header:!0,className:"text-center"},i.a.createElement("strong",null,"Settings")),i.a.createElement(k.a,{onClick:this.toggleIpfsSettings},i.a.createElement("i",{className:"fa fa-wrench"})," IPFS"),i.a.createElement(k.a,{header:!0,className:"text-center"},z.AppVersion)))),i.a.createElement("li",{className:"nav-item d-md-down-none"}))}},{key:"loggedOut",value:function(){var e=W.a.getConfig();return i.a.createElement("ul",{className:"nav navbar-nav ml-auto"},i.a.createElement("li",{className:"nav-item d-lg-none px-3"},i.a.createElement(S.a,{className:"login-btn",title:"Login with your ".concat(e.chain.name," account"),onClick:this.toggleLogin},i.a.createElement("i",{className:"fa fa-sign-in fa-lg"}))),i.a.createElement("li",{className:"nav-item d-md-down-none px-3"},i.a.createElement(S.a,{className:"login-btn",title:"Login with your ".concat(e.chain.name," account"),onClick:this.toggleLogin},i.a.createElement("i",{className:"fa fa-sign-in fa-lg"})," Login")),i.a.createElement("li",{className:"nav-item d-md-down-none"}))}},{key:"render",value:function(){var e=W.a.getConfig(),t=this.state.activeUser,a=null!==t?this.loggedIn(t):this.loggedOut();return i.a.createElement("header",{className:"app-header navbar"},i.a.createElement(L.ToastContainer,{position:"top-right",type:"default",autoClose:3e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,pauseOnHover:!0}),i.a.createElement(O.a,{isOpen:this.state.loginOpen,toggle:this.toggleLogin},i.a.createElement(C.a,{toggle:this.toggleLogin},"Login with ".concat(e.chain.name," account")),i.a.createElement(j.a,null,i.a.createElement(P.a,null,i.a.createElement(x.a,{className:this.state.validation.user?"":"has-danger"},i.a.createElement(F.a,{type:"text",name:"user",onBlur:this.onBlurLoginUser,value:this.state.login.user,onChange:this.onChangeLoginUser,invalid:!this.state.validation.user,className:"form-field",placeholder:"".concat(e.chain.name," username"),autoComplete:"username"})),i.a.createElement(x.a,{className:this.state.validation.pkey?"":"has-danger"},i.a.createElement(F.a,{type:"password",name:"pkey",onBlur:this.onBlurLoginPkey,value:this.state.login.pkey,onChange:this.onChangeLoginPkey,invalid:!this.state.validation.pkey,className:"form-field",placeholder:"Private posting key",autoComplete:"current-password"})),i.a.createElement(D.a,{color:"warning",className:"form-alert justify"},i.a.createElement("strong",null,"Attention!")," Your private posting key will be stored encrypted in your browser while you","'","re logged-in. For your security, it will never be sent to any server or through the network."))),i.a.createElement(T.a,null,i.a.createElement("div",{className:"form-message"},"Don","'","t have an account yet?",i.a.createElement("br",null),"Get yours at ",i.a.createElement("a",{href:e.chain.signup.link,target:"_blank",rel:"noopener noreferrer"},e.chain.signup.name)),i.a.createElement("div",{style:{flex:1}}),i.a.createElement(S.a,{color:"primary",onClick:this.doLogin,className:"form-submit",disabled:!this.state.validation.user||!this.state.validation.pkey},i.a.createElement("i",{className:"fa fa-sign-in fa-lg"})," Login")," ",i.a.createElement(S.a,{color:"secondary",onClick:this.toggleLogin,className:"form-cancel"},i.a.createElement("i",{className:"fa fa-close fa-lg"})," Cancel"))),i.a.createElement(O.a,{isOpen:this.state.ipfsOpen,toggle:this.toggleIpfsSettings},i.a.createElement(C.a,{toggle:this.toggleIpfsSettings},"IPFS Settings"),i.a.createElement(j.a,null,i.a.createElement("div",{className:"ipfs-status"},i.a.createElement("h1",null,i.a.createElement(A.a,{color:"success",style:{display:this.state.ipfs?"inline-block":"none"}},"Local IPFS Online"),i.a.createElement(A.a,{color:"danger",style:{display:this.state.ipfs?"none":"inline-block"}},"Local IPFS Offline"))),i.a.createElement("div",{style:{display:this.state.ipfs?"flex":"none"}},i.a.createElement("div",{className:"ipfs-data"},i.a.createElement("div",{className:"ipfs-data-item"},i.a.createElement("div",{className:"title"},"Using"),i.a.createElement("div",{className:"data"},this.state.ipfs?_.data(this.state.ipfs.RepoSize):"")),i.a.createElement("div",{className:"ipfs-data-item"},i.a.createElement("div",{className:"title"},"Storage Max"),i.a.createElement("div",{className:"data"},this.state.ipfs?_.data(this.state.ipfs.StorageMax):"")))),i.a.createElement(D.a,{color:"warning",className:"form-alert justify",style:{display:this.state.ipfs?"none":"inline-block"}},i.a.createElement("strong",null,"Attention!")," It is much better and faster to upload your content if you have IPFS installed locally and running. We are working to make this process as easy as possible, but until then you may try it with these instructions:",i.a.createElement("br",null),i.a.createElement("a",{href:"https://ipfs.io/docs/getting-started/",target:"_blank",rel:"noopener noreferrer"},"https://ipfs.io/docs/getting-started/"))),i.a.createElement(T.a,null,i.a.createElement("div",{style:{flex:1}}),i.a.createElement(S.a,{color:"secondary",onClick:this.toggleIpfsSettings,className:"form-cancel"},i.a.createElement("i",{className:"fa fa-close fa-lg"})," Close"))),i.a.createElement("button",{className:"navbar-toggler mobile-sidebar-toggler d-lg-none",onClick:this.mobileSidebarToggle,type:"button"},"\u2630"),i.a.createElement(U.a,{href:"/"}),i.a.createElement("ul",{className:"nav navbar-nav d-md-down-none"},i.a.createElement("li",{className:"nav-item px-3"},i.a.createElement(b.a,{to:"trending",className:window.location.href.endsWith("trending")?"nav-link active":"nav-link"},"Trending")),i.a.createElement("li",{className:"nav-item px-3"},i.a.createElement(b.a,{to:"hot",className:window.location.href.endsWith("hot")?"nav-link active":"nav-link"},"Hot")),i.a.createElement("li",{className:"nav-item px-3"},i.a.createElement(b.a,{to:"new",className:window.location.href.endsWith("new")?"nav-link active":"nav-link"},"New"))),a)}}]),t}(s.Component),H=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleClick",value:function(e){e.preventDefault(),e.target.parentElement.classList.toggle("open")}},{key:"render",value:function(){return i.a.createElement("div",{className:"sidebar"},i.a.createElement("nav",{className:"sidebar-nav"},i.a.createElement("ul",{className:"nav"},i.a.createElement("li",{className:"nav-item"},i.a.createElement(b.a,{to:"/feed",className:"nav-link",activeClassName:"active"},i.a.createElement("i",{className:"icon-home"})," Feed"),i.a.createElement(b.a,{to:"/trending",className:"nav-link",activeClassName:"active"},i.a.createElement("i",{className:"icon-heart"})," Trending"),i.a.createElement(b.a,{to:"/hot",className:"nav-link",activeClassName:"active"},i.a.createElement("i",{className:"icon-speedometer"})," Hot"),i.a.createElement(b.a,{to:"/new",className:"nav-link",activeClassName:"active"},i.a.createElement("i",{className:"icon-hourglass"})," New")))))}}]),t}(s.Component),J=a(348),Z=a(475),$=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.soundengine=a.props.soundengine,a.playlist=a.props.playlist;var n=a.playlist.getRandom(),s={sound:null,voted:a.playlist.checkVoted(a.props.current.song,a.auth.getAuthUser()),reposted:!1,random:n,playing:!1,duration:0,time:0,loading:!1,voting:!1,reposting:!1};return a.state={player:s,current:a.props.current},a.play=a.play.bind(Object(y.a)(Object(y.a)(a))),a.pause=a.pause.bind(Object(y.a)(Object(y.a)(a))),a.seekTo=a.seekTo.bind(Object(y.a)(Object(y.a)(a))),a.stop=a.stop.bind(Object(y.a)(Object(y.a)(a))),a.isPlaying=a.isPlaying.bind(Object(y.a)(Object(y.a)(a))),a.isLoading=a.isLoading.bind(Object(y.a)(Object(y.a)(a))),a.handleReady=a.handleReady.bind(Object(y.a)(Object(y.a)(a))),a.handlePlay=a.handlePlay.bind(Object(y.a)(Object(y.a)(a))),a.handlePause=a.handlePause.bind(Object(y.a)(Object(y.a)(a))),a.handleProgress=a.handleProgress.bind(Object(y.a)(Object(y.a)(a))),a.handleFinish=a.handleFinish.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistPlaySound=a.handlePlaylistPlaySound.bind(Object(y.a)(Object(y.a)(a))),a.toggleVote=a.toggleVote.bind(Object(y.a)(Object(y.a)(a))),a.handleRepost=a.handleRepost.bind(Object(y.a)(Object(y.a)(a))),a.togglePlay=a.togglePlay.bind(Object(y.a)(Object(y.a)(a))),a.prevTrack=a.prevTrack.bind(Object(y.a)(Object(y.a)(a))),a.nextTrack=a.nextTrack.bind(Object(y.a)(Object(y.a)(a))),a.toggleRandom=a.toggleRandom.bind(Object(y.a)(Object(y.a)(a))),a.clickVote=a.clickVote.bind(Object(y.a)(Object(y.a)(a))),a.clickRepost=a.clickRepost.bind(Object(y.a)(Object(y.a)(a))),a.soundengine.on("ready",a.handleReady),a.soundengine.on("audioprocess",a.handleProgress),a.soundengine.on("seek",a.handleProgress),a.soundengine.on("play",a.handlePlay),a.soundengine.on("pause",a.handlePause),a.soundengine.on("finish",a.handleFinish),a.playlist.on("play-sound",a.handlePlaylistPlaySound),a.playlist.on("voted",a.toggleVote),a.playlist.on("reposted",a.handleRepost),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"play",value:function(){this.state.player.loading||this.state.player.sound&&!this.state.player.playing&&this.soundengine.play()}},{key:"pause",value:function(){this.state.player.loading||this.state.player.sound&&this.state.player.playing&&this.soundengine.pause()}},{key:"setCurrentTime",value:function(e){this.state.player.loading||this.state.player.sound&&this.soundengine.setCurrentTime(e)}},{key:"seekTo",value:function(e){this.state.player.loading||this.state.player.sound&&this.soundengine.seekTo(e)}},{key:"stop",value:function(){this.state.player.loading||this.state.player.sound&&this.state.player.playing&&this.soundengine.stop()}},{key:"isPlaying",value:function(){return this.state.player.playing}},{key:"isLoading",value:function(){return this.state.player.loading}},{key:"timeToPos",value:function(e){return e/this.soundengine.getDuration()}},{key:"posToTime",value:function(e){return Math.round(e*this.soundengine.getDuration())}},{key:"handleReady",value:function(){var e,t=Math.round(this.soundengine.getDuration()),a=this.soundengine.getCurrentTime(),n=this.state.player.pos?this.posToTime(this.state.player.pos):this.state.player.time;a<n-5||a>n+5?(e=n,this.soundengine.setCurrentTime(e)):e=a,this.setState({player:Object(v.a)({},this.state.player,{duration:t,time:e,loading:!1,pos:0})}),this.state.player.playing&&!this.soundengine.isPlaying()&&this.soundengine.play()}},{key:"handlePlay",value:function(){this.setState({player:Object(v.a)({},this.state.player,{playing:!0})})}},{key:"handlePause",value:function(){if(!this.state.player.loading){var e=this.soundengine.getCurrentTime();this.setState({player:Object(v.a)({},this.state.player,{playing:!1,time:e})})}}},{key:"handleProgress",value:function(e){if(!this.state.player.loading){var t=this.state.player.duration;0===t&&(t=this.soundengine.getDuration()),this.setState({player:Object(v.a)({},this.state.player,{time:e,duration:t})})}}},{key:"handleFinish",value:function(){this.soundengine.seekTo(0),null===this.nextTrack()&&this.setState({player:Object(v.a)({},this.state.player,{playing:!1,time:0})})}},{key:"handlePlaylistPlaySound",value:function(e,t){var a=this.playlist.checkVoted(e,this.auth.getAuthUser());this.setState({player:Object(v.a)({},this.state.player,{sound:e,voted:a,reposted:!1,playing:!0,duration:0,time:0,pos:t,loading:!0,voting:!1,reposting:!1})})}},{key:"toggleVote",value:function(e){if(this.state.player.sound&&e.id===this.state.player.sound.id){var t=!this.state.player.voted;this.setState({player:Object(v.a)({},this.state.player,{voting:!1,voted:t})})}}},{key:"handleRepost",value:function(e){if(e.id===this.state.player.sound.id){this.setState({player:Object(v.a)({},this.state.player,{reposting:!1,reposted:!0})})}}},{key:"togglePlay",value:function(){this.soundengine.initIfNeeded(),this.state.player.loading||(this.state.player.sound?this.soundengine.playPause():this.nextTrack())}},{key:"prevTrack",value:function(){if(this.soundengine.initIfNeeded(),!this.state.player.loading){var e=this.playlist.getPrevSound();e&&(this.playlist.playSound(e,0),this.soundengine.load(this.playlist.getIpfsUrl(e.metadata.audio.files.sound,e)))}}},{key:"nextTrack",value:function(){if(this.soundengine.initIfNeeded(),!this.state.player.loading){var e=this.playlist.getNextSound();e&&(this.playlist.playSound(e,0),this.soundengine.load(this.playlist.getIpfsUrl(e.metadata.audio.files.sound,e)),null===this.playlist.getNextSound()&&this.playlist.getNextSoundsList())}}},{key:"toggleRandom",value:function(){var e=this.playlist.toggleRandom();this.setState({player:Object(v.a)({},this.state.player,{random:e})})}},{key:"clickVote",value:function(){this.state.player.voting||(this.playlist.voteSound(this.state.player.sound,!this.state.player.voted),this.setState({player:Object(v.a)({},this.state.player,{voting:!0})}))}},{key:"clickRepost",value:function(){this.state.reposting.reposting||this.state.player.reposted||(this.playlist.repostSound(this.state.player.sound),this.setState({player:Object(v.a)({},this.state.player,{reposting:!0})}))}},{key:"render",value:function(){var e,t,a,n=W.a.getConfig(),s=this.auth.getAuthUser();e=this.state.player.sound&&this.state.player.sound.metadata.audio.files.cover?i.a.createElement("div",{className:"cover-thumb d-md-down-none",style:{backgroundImage:"url("+this.playlist.getIpfsUrl(this.state.player.sound.metadata.audio.files.cover,this.state.player.sound)+")"}}):i.a.createElement("div",{className:"cover-thumb d-md-down-none"}),t=this.state.player.playing?i.a.createElement("button",{className:"footer-player-btn",onClick:this.togglePlay},i.a.createElement("i",{className:"fa fa-pause fa-lg"})):i.a.createElement("button",{className:"footer-player-btn",onClick:this.togglePlay},i.a.createElement("i",{className:"fa fa-play fa-lg"})),a=this.state.player.random?i.a.createElement("button",{className:"footer-player-btn active",onClick:this.toggleRandom},i.a.createElement("i",{className:"fa fa-random fa-lg"})):i.a.createElement("button",{className:"footer-player-btn",onClick:this.toggleRandom},i.a.createElement("i",{className:"fa fa-random fa-lg"}));var o,r,l=this.state.player.loading,c=l?100:this.state.player.duration,u=l?100:this.state.player.time,d=this.state.player.sound?"/@"+this.state.player.sound.author+"/"+this.state.player.sound.permlink:"";return o=this.state.player.sound&&s?this.state.player.voted?i.a.createElement("button",{onClick:this.clickVote,className:"footer-player-btn active"},i.a.createElement("i",{className:"fa fa-heart fa-lg"})):i.a.createElement("button",{onClick:this.clickVote,className:"footer-player-btn"},i.a.createElement("i",{className:"fa fa-heart fa-lg"})):i.a.createElement("button",{className:"footer-player-btn disabled"},i.a.createElement("i",{className:"fa fa-heart fa-lg"})),r=this.state.player.sound&&s?this.state.player.reposted?i.a.createElement("button",{onClick:this.clickRepost,className:"footer-player-btn active"},i.a.createElement("i",{className:"fa fa-retweet fa-lg"})):i.a.createElement("button",{onClick:this.clickRepost,className:"footer-player-btn"},i.a.createElement("i",{className:"fa fa-retweet fa-lg"})):i.a.createElement("button",{className:"footer-player-btn disabled"},i.a.createElement("i",{className:"fa fa-retweet fa-lg"})),i.a.createElement("footer",{className:"app-footer"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("button",{className:"footer-player-btn",onClick:this.prevTrack},i.a.createElement("i",{className:"fa fa-step-backward fa-lg"})),t,i.a.createElement("button",{className:"footer-player-btn",onClick:this.nextTrack},i.a.createElement("i",{className:"fa fa-step-forward fa-lg"})),a,i.a.createElement("div",{className:"play-time d-sm-down-none"},_.time(this.state.player.time)),i.a.createElement(Z.a,{className:"footer-player-prg d-sm-down-none",value:u,max:c,animated:l}),i.a.createElement("div",{className:"duration d-sm-down-none"},_.time(this.state.player.duration)),i.a.createElement(J.a,{to:d},e),i.a.createElement("div",{className:"spacer d-lg-up-none"}),o,r,i.a.createElement("div",{className:"spacer d-md-down-none"}),i.a.createElement("span",{className:"d-md-down-none author-tag"},"Made with ",i.a.createElement("i",{className:"fa fa-heart"})," by ",i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"".concat(n.chain.website,"/@").concat(n.accounts.creator)},"@",n.accounts.creator)))))}}]),t}(s.Component),Q=a(109),K=a.n(Q),X=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"encrypt",value:function(t,a){return a=e.xor_encrypt(t,a),e.b64_encode(a)}},{key:"decrypt",value:function(t,a){return a=e.b64_decode(a),e.xor_decrypt(t,a)}},{key:"b64_encode",value:function(t){var a,n,s,i,o,r,l=0,c="";if(!t)return t;do{a=(o=t[l++]<<16|t[l++]<<8|t[l++])>>18&63,n=o>>12&63,s=o>>6&63,i=63&o,c+=e.b64_table.charAt(a)+e.b64_table.charAt(n)+e.b64_table.charAt(s)+e.b64_table.charAt(i)}while(l<t.length);return((r=t.length%3)?c.slice(0,r-3):c)+"===".slice(r||3)}},{key:"b64_decode",value:function(t){var a,n,s,i,o,r,l=0,c=[];if(!t)return t;t+="";do{a=(r=e.b64_table.indexOf(t.charAt(l++))<<18|e.b64_table.indexOf(t.charAt(l++))<<12|(i=e.b64_table.indexOf(t.charAt(l++)))<<6|(o=e.b64_table.indexOf(t.charAt(l++))))>>16&255,n=r>>8&255,s=255&r,c.push(a),64!==i&&(c.push(n),64!==o&&c.push(s))}while(l<t.length);return c}},{key:"keyCharAt",value:function(e,t){return e.charCodeAt(Math.floor(t%e.length))}},{key:"xor_encrypt",value:function(t,a){return K.a.map(a,function(a,n){return a.charCodeAt(0)^e.keyCharAt(t,n)})}},{key:"xor_decrypt",value:function(t,a){return K.a.map(a,function(a,n){return String.fromCharCode(a^e.keyCharAt(t,n))}).join("")}}]),e}();X.b64_table="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var Y=function(){function e(){Object(d.a)(this,e);var t=W.a.getConfig();B.a.api.setOptions({url:t.chain.nodes[0]})}return Object(h.a)(e,[{key:"authenticate",value:function(e,t){var a=this;return new Promise(function(n,s){return B.a.api.getAccounts([e],function(e,i){if(e)s(e);else{var o=i[0];if(!B.a.auth.isWif(t))throw new Error("Invalid private posting key");var r=B.a.auth.wifToPublic(t);if(!o.posting.key_auths.find(function(e){return e[0]===r}))throw new Error("Invalid credentials");var l=a.saveAuthUser(o,t);n(l)}})})}},{key:"saveAuthUser",value:function(e,t){var a={id:e.id,name:e.name,keys:{public:B.a.auth.wifToPublic(t),private:t}},n=this.getSecret(),s=X.encrypt(n,JSON.stringify(a)),i=window.localStorage.getItem("u"),o=i?JSON.parse(i):[];return o.push(s),window.localStorage.setItem("u",JSON.stringify(o)),window.localStorage.setItem("a",s),delete a.keys,a}},{key:"getSecret",value:function(){var e=window.localStorage.getItem("r");return e||(e=function(){var e=Math.round(1e8*Math.random()).toString(),t=e.slice(0,5),a=e.slice(5);return t+a+a+t+t+a}(),window.localStorage.setItem("r",e)),e}},{key:"getAuthUserList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],a=this.getSecret(),n=window.localStorage.getItem("u"),s=n?JSON.parse(n):[];if(s.length)for(var i=0;i<s.length;i++){var o=X.decrypt(a,s[i]);if(!o)return this.logoutAll(),[];var r=JSON.parse(o);e&&(r.token=s[i]),delete r.keys,t.push(r)}return t}},{key:"getAuthUser",value:function(){var e=this.getSecret(),t=window.localStorage.getItem("a"),a=null;if(t){var n=X.decrypt(e,t);if(!n)return this.logoutAll(),[];delete(a=JSON.parse(n)).keys}return a}},{key:"getAuthWif",value:function(){var e=this.getSecret(),t=window.localStorage.getItem("a"),a=null;if(t){var n=X.decrypt(e,t);if(!n)return this.logoutAll(),null;a=JSON.parse(n).keys.private}return a}},{key:"selectUser",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.getAuthUserList(!0);(e=null!=t?a.find(function(e){return e.id===t}):a.length?a[0]:null)?(window.localStorage.setItem("a",e.token),delete e.token):window.localStorage.removeItem("a")}},{key:"isAuth",value:function(){return null!=this.getAuthUser()}},{key:"logout",value:function(){var e=window.localStorage.getItem("u"),t=e?JSON.parse(e):[],a=window.localStorage.getItem("a");t.splice(t.indexOf(a),1),window.localStorage.setItem("u",JSON.stringify(t)),this.selectUser()}},{key:"logoutAll",value:function(){window.localStorage.removeItem("a"),window.localStorage.removeItem("u"),window.localStorage.removeItem("r")}}]),e}(),ee=a(189),te=a(38);function ae(e){var t=new te.a,a=new XMLHttpRequest,n=!1;return a.open(e.method||"GET",e.url,!0),a.responseType=e.responseType||"json",a.addEventListener("progress",function(e){t.fireEvent("progress",e),e.lengthComputable&&e.loaded===e.total&&(n=!0)}),a.addEventListener("load",function(e){n||t.fireEvent("progress",e),t.fireEvent("load",e),200===a.status||206===a.status?t.fireEvent("success",a.response,e):t.fireEvent("error",e)}),a.addEventListener("error",function(e){return t.fireEvent("error",e)}),a.send(),t.xhr=a,t}function ne(){return"wavesurfer_"+Math.random().toString(32).substring(2)}function se(e){var t=-1/0;return Object.keys(e).forEach(function(a){e[a]>t&&(t=e[a])}),t}function ie(e){var t=Number(1/0);return Object.keys(e).forEach(function(a){e[a]<t&&(t=e[a])}),t}function oe(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return a.forEach(function(t){Object.keys(t).forEach(function(a){e[a]=t[a]})}),e}function re(e,t){return Object.keys(t).forEach(function(a){e.style[a]!==t[a]&&(e.style[a]=t[a])}),e}var le=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);function ce(e){return function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return le(function(){return e.apply(void 0,a)})}}var ue=a(110),de=a.n(ue),he=a(190),me=a.n(he);function pe(e){return e?de()(e,{whiteList:[],stripIgnoreTag:!0,stripIgnoreTagBody:["script"]}):e}var fe={filterUrl:function(e){if(""===e.trim())return e;var t=document.createElement("a");return t.href=pe(e),t.protocol+"//"+t.host+t.pathname+t.search+t.hash},removeHtml:pe,filterHtml:function(e){return e?me.a.link(de()(e,{whiteList:{article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],div:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},stripIgnoreTag:!0,stripIgnoreTagBody:["script"]})):e}};function ge(e,t){var a=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,n=navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(-1===navigator.userAgent.indexOf("iP")&&(a||n)){var s=document.createElement("a");if(s.href=e,void 0!==s.download&&(t||(t=e.substring(e.lastIndexOf("/")+1)),s.download=t),document.createEvent){var i=document.createEvent("MouseEvents");return i.initEvent("click",!0,!0),void s.dispatchEvent(i)}}-1===e.indexOf("?")&&(e+="?download"),window.open(e,"_self")}var ve=a(165),ye=a.n(ve),be=a(37),ke="playing",Ee="paused",we="finished",Ne=function(e){function t(e){var a,n,s;return Object(d.a)(this,t),(s=Object(m.a)(this,Object(p.a)(t).call(this))).audioContext=null,s.offlineAudioContext=null,s.stateBehaviors=(a={},Object(be.a)(a,ke,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),Object(be.a)(a,Ee,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),Object(be.a)(a,we,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),a),s.params=e,s.ac=e.audioContext||s.getAudioContext(),s.lastPlay=s.ac.currentTime,s.startPosition=0,s.scheduledPause=null,s.states=(n={},Object(be.a)(n,ke,Object.create(s.stateBehaviors[ke])),Object(be.a)(n,Ee,Object.create(s.stateBehaviors[Ee])),Object(be.a)(n,we,Object.create(s.stateBehaviors[we])),n),s.analyser=null,s.buffer=null,s.filters=[],s.gainNode=null,s.mergedPeaks=null,s.offlineAc=null,s.playbackRate=1,s.analyser=null,s.scriptNode=null,s.source=null,s.splitPeaks=[],s.state=null,s}return Object(f.a)(t,e),Object(h.a)(t,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.SoundEngineAudioContext||(window.SoundEngineAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.SoundEngineAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.SoundEngineOfflineAudioContext||(window.SoundEngineOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.SoundEngineOfflineAudioContext}}]),Object(h.a)(t,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(Ee),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach(function(e){e&&e.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce(function(e,t){return e.connect(t),t},this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(t.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(t.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime(),a=e.getDuration();t>=a?(e.setState(we),e.fireEvent("pause")):t>=e.scheduledPause?e.pause():e.state===e.states[ke]&&e.fireEvent("audioprocess",t,a)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=null}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setVolume",value:function(e){this.gainNode.gain.value=e}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,a){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(e,function(e){return t(e)},a)}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!==2*this.mergedPeaks.length-1+2){var t=this.getPeaksData(this.buffer,e);this.splitPeaks=t.splitPeaks,this.mergedPeaks=t.mergedPeaks}}},{key:"getPeaksData",value:function(e,t){var a,n=[],s=[],i=e?e.numberOfChannels:1;for(a=0;a<i;a++)n[a]=[],n[a][2*(t-1)]=0,n[a][2*(t-1)+1]=0;return s[2*(t-1)]=0,s[2*(t-1)+1]=0,{splitPeaks:n,mergedPeaks:s}}},{key:"getPeaks",value:function(e,t,a){if(this.setLength(e),!this.buffer.length){var n=this.createBuffer(1,4096,this.sampleRate);this.buffer=n.buffer}var s=this.getPeaksFromBuffer(this.buffer,e,t,a);return this.splitPeaks=s.splitPeaks,this.mergedPeaks=s.mergedPeaks,this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPeaksFromBuffer",value:function(e,t,a,n){a=a||0,n=n||t-1;var s,i=this.getPeaksData(e,t),o=i.splitPeaks,r=i.mergedPeaks,l=e.length/t,c=~~(l/10)||1,u=e.numberOfChannels;for(s=0;s<u;s++){var d=o[s],h=e.getChannelData(s),m=void 0;for(m=a;m<=n;m++){var p=~~(m*l),f=~~(p+l),g=0,v=0,y=void 0;for(y=p;y<f;y+=c){var b=h[y];b>v&&(v=b),b<g&&(g=b)}d[2*m]=v,d[2*m+1]=g,(0===s||v>r[2*m])&&(r[2*m]=v),(0===s||g<r[2*m+1])&&(r[2*m+1]=g)}}return{splitPeaks:o,mergedPeaks:r}}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"===typeof this.ac.close&&"closed"!==this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.SoundEngineAudioContext=null,window.SoundEngineOfflineAudioContext=null)}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states[ke]}},{key:"getDuration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states[we]&&this.setState(Ee),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var a=this.seekTo(e,t);e=a.start,t=a.end,this.scheduledPause=t,this.source.start(0,e,t-e),"suspended"===this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState(ke),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(Ee),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e=e||1,this.isPaused()?this.playbackRate=e:(this.pause(),this.playbackRate=e,this.play())}}]),t}(te.a);Ne.scriptBufferSize=256;var Se=a(192),Oe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).params=e,a.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},a.mediaType=e.mediaType.toLowerCase(),a.elementPosition=e.elementPosition,a.playbackRate=1,a.buffer=null,a.onPlayEnd=null,a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"init",value:function(){var e=this;this.setPlaybackRate(this.params.audioRate),setInterval(function(){e.isPaused()||e.fireEvent("audioprocess",e.getCurrentTime(),e.getDuration())},100)}},{key:"createTimer",value:function(){var e=this;this.on("play",function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime(),e.getDuration()),(window.requestAnimationFrame||window.webkitRequestAnimationFrame)(t))})}},{key:"load",value:function(e,t,a){var n=document.createElement(this.mediaType);n.controls=this.params.mediaControls,n.autoplay=this.params.autoplay||!1,n.preload=a||"metadata",n.src=e,n.style.width="100%";var s=t.querySelector(this.mediaType);s&&t.removeChild(s),t.appendChild(n),this._load(n)}},{key:"loadElt",value:function(e){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e)}},{key:"_load",value:function(e){var t=this;"function"===typeof e.load&&e.load(),e.addEventListener("error",function(){t.fireEvent("error","Error loading media element")}),e.addEventListener("canplay",function(){t.fireEvent("canplay")}),e.addEventListener("ended",function(){t.fireEvent("finish")}),e.addEventListener("play",function(){t.fireEvent("play")}),e.addEventListener("pause",function(){t.fireEvent("pause")}),this.media=e,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){var e=(this.buffer||this.media).duration;return isNaN(e)?0:(e>=1/0&&(e=this.media.seekable.end(0)),e)}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null!=e&&(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e),this.media.play(),t&&this.setPlayEnd(t)}},{key:"pause",value:function(){this.media&&this.media.pause(),this.clearPlayEnd()}},{key:"setPlayEnd",value:function(e){var t=this;this._onPlayEnd=function(a){a>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,a,n){return this.buffer?Object(Se.a)(Object(p.a)(t.prototype),"getPeaks",this).call(this,e,a,n):[]}},{key:"getVolume",value:function(){return this.media.volume}},{key:"setVolume",value:function(e){this.media.volume=e}},{key:"destroy",value:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}]),t}(Ne),Ce=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this))).defaultParams={audioContext:null,audioRate:1,backend:"MediaElement",mediaContainer:null,mediaControls:!1,mediaType:"audio",normalize:!1,skipLength:2},a.backends={MediaElement:Oe,WebAudio:Ne},a.util=n,a.params=oe({},a.defaultParams,e),a.savedVolume=0,a.isMuted=!1,a.tmpEvents=[],a.currentAjax=null,a.arraybuffer=null,a.backend=null,a.Backend=a.backends[a.params.backend],a.isDestroyed=!1,a.isReady=!1,Object(m.a)(a,Object(y.a)(Object(y.a)(a)))}return Object(f.a)(t,e),Object(h.a)(t,null,[{key:"create",value:function(e){return new t(e).init()}}]),Object(h.a)(t,[{key:"initIfNeeded",value:function(){return this.backend?this:this.init()}},{key:"init",value:function(){if("MediaElement"===this.params.backend&&("string"===typeof this.params.mediaContainer?this.mediaContainer=document.querySelector(this.params.mediaContainer):this.mediaContainer=this.params.mediaContainer,!this.mediaContainer))throw new Error("Media Container element not found");return this.createBackend(),this}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),"WebAudio"!==this.params.backend||this.Backend.prototype.supportsWebAudio.call(null)||(this.params.backend="MediaElement"),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",function(){return e.fireEvent("finish")}),this.backend.on("play",function(){return e.fireEvent("play")}),this.backend.on("pause",function(){return e.fireEvent("pause")}),this.backend.on("audioprocess",function(t,a){e.fireEvent("audioprocess",t,a)})}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){var t=this.getDuration();0===t&&this.seekTo(0),t<=e?this.seekTo(1):this.seekTo(e/t)}},{key:"getCurrentPos",value:function(){var e=this.getDuration();if(0===e)return 0;var t=this.getCurrentTime()/e;return e<=t?1:t}},{key:"setCurrentPos",value:function(e){var t=this.getDuration();0===t&&this.seekTo(0),t<=e?this.seekTo(1):this.seekTo(e)}},{key:"play",value:function(e,t){this.backend.play(e,t)}},{key:"pause",value:function(){this.backend.isPaused()||this.backend.pause()}},{key:"playPause",value:function(){this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,a=this.getCurrentTime()||0;a=Math.max(0,Math.min(t,a+(e||0))),this.seekTo(a/t)}},{key:"seekTo",value:function(e){var t=this.backend.isPaused();t||this.backend.pause(),this.backend.seekTo(e*this.getDuration()),t||this.backend.play(),this.fireEvent("seek",e*this.getDuration())}},{key:"stop",value:function(){this.pause(),this.seekTo(0)}},{key:"setVolume",value:function(e){this.backend.setVolume(e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted&&(e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0):(this.backend.setVolume(this.savedVolume),this.isMuted=!1))}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,function(e){t.isDestroyed||t.loadDecodedBuffer(e)})}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.fireEvent("ready"),this.isReady=!0}},{key:"loadBlob",value:function(e){var t=this,a=new FileReader;a.addEventListener("progress",function(e){return t.onProgress(e)}),a.addEventListener("load",function(e){return t.loadArrayBuffer(e.target.result)}),a.addEventListener("error",function(){return t.fireEvent("error","Error reading file")}),a.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t){switch(this.empty(),this.isMuted=!1,this.params.backend){default:case"WebAudio":return this.loadBuffer(e);case"MediaElement":return this.loadMediaElement(e,t)}}},{key:"loadBuffer",value:function(e){var t=this;return this.getArrayBuffer(e,function(e){return t.loadArrayBuffer(e)})}},{key:"loadMediaElement",value:function(e,t){var a=this,n=e;if("string"===typeof e)this.backend.load(n,this.mediaContainer,t);else{var s=e;this.backend.loadElt(s),n=s.src}this.tmpEvents.push(this.backend.once("canplay",function(){a.fireEvent("ready")}),this.backend.once("error",function(e){return a.fireEvent("error",e)}))}},{key:"decodeArrayBuffer",value:function(e,t){var a=this;this.arraybuffer=e,this.backend.decodeArrayBuffer(e,function(n){a.isDestroyed||a.arraybuffer!==e||(t(n),a.arraybuffer=null)},function(){return a.fireEvent("error","Error decoding audiobuffer")})}},{key:"getArrayBuffer",value:function(e,t){var a=this,n=ae({url:e,responseType:"arraybuffer"});return this.currentAjax=n,this.tmpEvents.push(n.on("progress",function(e){a.onProgress(e)}),n.on("success",function(e,n){t(e),a.currentAjax=null}),n.on("error",function(e){a.fireEvent("error","XHR error: "+e.target.statusText),a.currentAjax=null})),n}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"getPeaks",value:function(e,t,a){return this.backend.getPeaks(e,t,a)}},{key:"getPeaksFromBuffer",value:function(e,t,a,n){var s=this.backend.getPeaksFromBuffer(e,t,a,n);return this.params.splitChannels?s.splitPeaks:s.mergedPeaks}},{key:"exportPCM",value:function(e,t,a,n,s){e=e||1024,t=t||0,a=a||e,n=n||1e4;var i=this.backend.getPeaks(e,t,a),o=[].map.call(i,function(e){return Math.round(e*n)/n});return JSON.stringify(o)}},{key:"cancelAjax",value:function(){this.currentAjax&&(this.currentAjax.xhr.abort(),this.currentAjax=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(e){return e.un()})}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.cancelAjax(),this.clearTmpEvents()}},{key:"destroy",value:function(){this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),this.backend.destroy(),this.isDestroyed=!0,this.arraybuffer=null}}]),t}(te.a);Ce.util=n;var je=function(e){function t(e,a){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this))).tags=["house","dance"],n.query=null,n.params=null,n.sounds=[],n.history=[],n.random=!1,n.current=null,n.steem=e,n.ipfs=a,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"getIpfsUrl",value:function(e,t){var a=t&&t.metadata&&t.metadata.audio&&t.metadata.audio.files&&t.metadata.audio.files.node?t.metadata.audio.files.node:void 0;return this.ipfs.getUrl(e,a)}},{key:"getRandom",value:function(){return this.random}},{key:"setRandom",value:function(e){this.random=e}},{key:"toggleRandom",value:function(){return this.random=!this.random,this.random}},{key:"getCurrentSound",value:function(){return this.current}},{key:"getPrevSound",value:function(){var e,t=this;if(!this.current)return 0===this.sounds.length?null:(e=this.random?this.sounds[Math.floor(Math.random()*this.sounds.length)]:this.sounds[0],this.history.push(e),e);var a=this.history.indexOf(this.history.find(function(e){return e.id===t.current.id}));if(-1===a&&(a=this.history.length,this.history.push(this.current)),0===a){if(this.random){var n=this.sounds.filter(function(e){return-1===t.history.indexOf(e)});if(0===n.length)return null;var s=Math.floor(Math.random()*n.length);return this.history.unshift(n[s]),n[s]}var i=this.sounds.indexOf(this.sounds.find(function(e){return e.id===t.current.id}))-1;if(-1===i)return null;var o=this.history.indexOf(this.sounds[i]);return-1!==o&&this.history.splice(o,1),this.history.unshift(this.sounds[i]),this.sounds[i]}return this.history[a-1]}},{key:"getNextSound",value:function(){var e,t=this;if(!this.current)return 0===this.sounds.length?null:(e=this.random?this.sounds[Math.floor(Math.random()*this.sounds.length)]:this.sounds[0],this.history.push(e),e);var a=this.history.indexOf(this.history.find(function(e){return e.id===t.current.id}));if(-1===a&&(a=this.history.length,this.history.push(this.current)),a===this.history.length-1){if(this.random){var n=this.sounds.filter(function(e){return-1===t.history.indexOf(e)});if(0===n.length)return null;var s=Math.floor(Math.random()*n.length);return this.history.push(n[s]),n[s]}var i=this.sounds.indexOf(this.sounds.find(function(e){return e.id===t.current.id}))+1;if(i===this.sounds.length)return null;var o=this.history.indexOf(this.sounds[i]);return-1!==o&&this.history.splice(o,1),this.history.push(this.sounds[i]),this.sounds[i]}return this.history[a+1]}},{key:"getSoundsList",value:function(e){var t,a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e===this.query&&n===this.params)return this.sounds;switch(this.history=[],this.current&&this.history.push(this.current),this.query=e,this.params=n,this.sounds=[],this.query){default:case"feed":t=this.steem.getSoundsFeed();break;case"trending":t=this.steem.getSoundsTrending(n.category);break;case"hot":t=this.steem.getSoundsHot(n.category);break;case"new":t=this.steem.getSoundsNew(n.category);break;case"user":t=this.steem.getSoundsForUser(this.params.user)}t.then(function(e){var t=[],n=e.filter(function(e){return void 0===t.find(function(t){return t.author===e.author&&t.metadata.audio.title===e.metadata.audio.title})&&(t.push(e),!0)});a.sounds=n,a.fireEvent("sounds",a.sounds)}).catch(function(e){console.log("Error getting sounds:",e),a.fireEvent("sounds-error",e)})}},{key:"getNextSoundsList",value:function(){var e=this;if(0!==this.sounds.length){var t,a=this.sounds[this.sounds.length-1];switch(this.query){default:case"feed":t=this.steem.getSoundsFeed(a);break;case"trending":t=this.steem.getSoundsTrending(this.params.category,a);break;case"hot":t=this.steem.getSoundsHot(this.params.category,a);break;case"new":t=this.steem.getSoundsNew(this.params.category,a);break;case"user":t=this.steem.getSoundsForUser(this.params.user,a)}t.then(function(t){var a=e.sounds,n=t.filter(function(e){return void 0===a.find(function(t){return t.author===e.author&&t.metadata.audio.title===e.metadata.audio.title})&&(a.push(e),!0)});e.sounds=e.sounds.concat(n),e.fireEvent("next-sounds",n)}).catch(function(t){console.log("Error getting sounds:",t),e.fireEvent("sounds-error",t)})}}},{key:"playSound",value:function(e,t){var a=this;this.current=e,-1===this.history.indexOf(e)&&this.history.push(e),setTimeout(function(){return a.fireEvent("play-sound",e,t)},0)}},{key:"checkVoted",value:function(e,t){if(!e||!t)return!1;var a=void 0!==e.active_votes.find(function(e){return e.voter===t.name&&e.percent>0});return a&&(this.ipfs.pinIfWeCan(e.metadata.audio.files.sound),this.ipfs.pinIfWeCan(e.metadata.audio.files.peaks),this.ipfs.pinIfWeCan(e.metadata.audio.files.cover)),a}},{key:"checkFlagged",value:function(e,t){return!(!e||!t)&&void 0!==e.active_votes.find(function(e){return e.voter===t.name&&e.percent<0})}},{key:"voteSound",value:function(e,t){var a=this;e&&(t&&(this.ipfs.pinIfWeCan(e.metadata.audio.files.sound),this.ipfs.pinIfWeCan(e.metadata.audio.files.peaks),this.ipfs.pinIfWeCan(e.metadata.audio.files.cover)),this.steem.voteSound(e,t).then(function(t){a.fireEvent("voted",e)}).catch(function(e){console.log("Error voting:",e),a.fireEvent("voting-error",e)}))}},{key:"repostSound",value:function(e){var t=this;e&&this.steem.repostSound(e).then(function(a){t.fireEvent("reposted",e)}).catch(function(e){console.log("Error reposting:",e),t.fireEvent("reposting-error",e)})}},{key:"flagSound",value:function(e,t){var a=this;e&&this.steem.flagSound(e,t).then(function(t){a.fireEvent("flagged",e)}).catch(function(e){console.log("Error flagging:",e),a.fireEvent("flagging-error",e)})}},{key:"getCategoryLink",value:function(e){var t=this.query;return t&&"feed"!==t&&"user"!==t||(t="trending"),"/"+e+"/"+t}},{key:"getLocalIpfsStatus",value:function(){return this.ipfs.getLocalStatus()}}]),t}(te.a),Pe=a(48),xe=function(e){function t(e,a){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e,a))).maxCanvasWidth=a.maxCanvasWidth,n.maxCanvasElementWidth=Math.round(a.maxCanvasWidth/a.pixelRatio),n.hasProgressCanvas=a.waveColor!==a.progressColor,n.halfPixel=.5/a.pixelRatio,n.canvases=[],n.progressWave=null,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor,pointerEvents:"none"})),this.addCanvas()}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),a=Math.ceil(t/this.maxCanvasElementWidth);this.canvases.length<a;)this.addCanvas();for(;this.canvases.length>a;)this.removeCanvas();this.canvases.forEach(function(t,a){var n=e.maxCanvasWidth+2*Math.ceil(e.params.pixelRatio/2);a===e.canvases.length-1&&(n=e.width-e.maxCanvasWidth*(e.canvases.length-1)),e.updateDimensions(t,n,e.height),e.clearWaveForEntry(t)})}},{key:"addCanvas",value:function(){var e={},t=this.maxCanvasElementWidth*this.canvases.length;e.wave=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"})),e.waveCtx=e.wave.getContext("2d"),this.hasProgressCanvas&&(e.progress=this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%"})),e.progressCtx=e.progress.getContext("2d")),this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases.pop();e.wave.parentElement.removeChild(e.wave),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress)}},{key:"updateDimensions",value:function(e,t,a){var n=Math.round(t/this.params.pixelRatio),s=Math.round(this.width/this.params.pixelRatio);e.start=e.waveCtx.canvas.offsetLeft/s||0,e.end=e.start+n/s,e.waveCtx.canvas.width=t,e.waveCtx.canvas.height=a,this.style(e.waveCtx.canvas,{width:n+"px"}),this.style(this.progressWave,{display:"block"}),this.hasProgressCanvas&&(e.progressCtx.canvas.width=t,e.progressCtx.canvas.height=a,this.style(e.progressCtx.canvas,{width:n+"px"}))}},{key:"clearWave",value:function(){var e=this;this.canvases.forEach(function(t){return e.clearWaveForEntry(t)})}},{key:"clearWaveForEntry",value:function(e){e.waveCtx.clearRect(0,0,e.waveCtx.canvas.width,e.waveCtx.canvas.height),this.hasProgressCanvas&&e.progressCtx.clearRect(0,0,e.progressCtx.canvas.width,e.progressCtx.canvas.height)}},{key:"drawBars",value:function(e,t,a,n){var s=this;ce(function(e,t,a,n){if(e){if(e[0]instanceof Array){var i=e;if(s.params.splitChannels)return s.setHeight(i.length*s.params.height*s.params.pixelRatio),void i.forEach(function(e,t){return s.drawBars(e,t,a,n)});e=i[0]}var o=[].some.call(e,function(e){return e<0})?2:1,r=s.width,l=s.params.height*s.params.pixelRatio,c=l*t||0,u=l/2,d=e.length/o,h=s.params.barWidth*s.params.pixelRatio,m=h+Math.max(s.params.pixelRatio,~~(h/2)),p=1/s.params.barHeight;if(s.params.normalize){var f=se(e),g=ie(e);p=-g>f?-g:f}for(var v=d/r,y=a;y<n;y+=m){var b=e[Math.floor(y*v*o)]||0,k=Math.round(b/p*u);s.fillRect(y+s.halfPixel,u-k+c,h+s.halfPixel,2*k)}}})(e,t,a,n)}},{key:"drawWave",value:function(e,t,a,n){var s=this;ce(function(e,t,a,n){if(e[0]instanceof Array){var i=e;if(s.params.splitChannels)return s.setHeight(i.length*s.params.height*s.params.pixelRatio),void i.forEach(function(e,t){return s.drawWave(e,t,a,n)});e=i[0]}if(![].some.call(e,function(e){return e<0})){var o,r=[],l=e.length;for(o=0;o<l;o++)r[2*o]=e[o],r[2*o+1]=-e[o];e=r}var c=s.params.height*s.params.pixelRatio,u=c*t||0,d=c/2,h=1/s.params.barHeight;if(s.params.normalize){var m=se(e),p=ie(e);h=-p>m?-p:m}s.drawLine(e,h,d,u,a,n),s.fillRect(0,d+u-s.halfPixel,s.width,s.halfPixel)})(e,t,a,n)}},{key:"drawLine",value:function(e,t,a,n,s,i){var o=this;this.canvases.forEach(function(r){o.setFillStyles(r),o.drawLineToContext(r,r.waveCtx,e,t,a,n,s,i),o.drawLineToContext(r,r.progressCtx,e,t,a,n,s,i)})}},{key:"drawLineToContext",value:function(e,t,a,n,s,i,o,r){if(t){var l=a.length/2,c=this.params.fillParent&&this.width!==l?this.width/l:1,u=Math.round(l*e.start),d=Math.round(l*e.end)+1;if(!(u>r||d<o)){var h,m,p=Math.max(u,o),f=Math.min(d,r);for(t.beginPath(),t.moveTo((p-u)*c+this.halfPixel,s+i),h=p;h<f;h++){var g=a[2*h]||0,v=Math.round(g/n*s);t.lineTo((h-u)*c+this.halfPixel,s-v+i)}for(m=f-1;m>=p;m--){var y=a[2*m+1]||0,b=Math.round(y/n*s);t.lineTo((m-u)*c+this.halfPixel,s-b+i)}t.closePath(),t.fill()}}}},{key:"fillRect",value:function(e,t,a,n){var s,i=Math.floor(e/this.maxCanvasWidth),o=Math.min(Math.ceil((e+a)/this.maxCanvasWidth)+1,this.canvases.length);for(s=i;s<o;s++){var r=this.canvases[s],l=s*this.maxCanvasWidth,c={x1:Math.max(e,s*this.maxCanvasWidth),y1:t,x2:Math.min(e+a,s*this.maxCanvasWidth+r.waveCtx.canvas.width),y2:t+n};c.x1<c.x2&&(this.setFillStyles(r),this.fillRectToContext(r.waveCtx,c.x1-l,c.y1,c.x2-c.x1,c.y2-c.y1),this.fillRectToContext(r.progressCtx,c.x1-l,c.y1,c.x2-c.x1,c.y2-c.y1))}}},{key:"fillRectToContext",value:function(e,t,a,n,s){e&&e.fillRect(t,a,n,s)}},{key:"setFillStyles",value:function(e){e.waveCtx.fillStyle=this.params.waveColor,this.hasProgressCanvas&&(e.progressCtx.fillStyle=this.params.progressColor)}},{key:"getImage",value:function(e,t){var a=this.canvases.map(function(a){return a.wave.toDataURL(e,t)});return a.length>1?a:a[0]}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}]),t}(function(e){function t(e,a){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this))).container=e,n.params=a,n.width=0,n.height=a.height*n.params.pixelRatio,n.lastPos=0,n.wrapper=null,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"style",value:function(e,t){return re(e,t)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var a,n=e.targetTouches?e.targetTouches[0].clientX:e.clientX,s=this.wrapper.getBoundingClientRect(),i=this.width,o=this.getWidth();return!this.params.fillParent&&i<o?(a=(n-s.left)*this.params.pixelRatio/i||0)>1&&(a=1):a=(n-s.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,a}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",function(t){var a=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==a){var n=e.wrapper.getBoundingClientRect();if(t.clientY>=n.bottom-a)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))}),this.wrapper.addEventListener("scroll",function(t){return e.fireEvent("scroll",t)})}},{key:"drawPeaks",value:function(e,t,a,n){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,a,n):this.drawWave(e,0,a,n)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var a=this.wrapper.scrollLeft,n=~~(this.wrapper.clientWidth/2),s=this.wrapper.scrollWidth-this.wrapper.clientWidth,i=e-n,o=i-a;if(0!==s){if(!t&&-n<=o&&o<n){i=a+(o=Math.max(-5,Math.min(5,o)))}(i=Math.max(0,Math.min(s,i)))!==a&&(this.wrapper.scrollLeft=i)}}},{key:"getScrollX",value:function(){return Math.round(this.wrapper.scrollLeft*this.params.pixelRatio)}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){return this.width!==e&&(this.width=e,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"setHeight",value:function(e){return e!==this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,a=Math.round(e*this.width)*t;if(a<this.lastPos||a-this.lastPos>=t){if(this.lastPos=a,this.params.scrollParent&&this.params.autoCenter){var n=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(n)}this.updateProgress(a)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode===this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,a,n){}},{key:"drawWave",value:function(e,t,a,n){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}]),t}(te.a)),Fe=function(e){function t(e){var a;if(Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this))).defaultParams={autoCenter:!0,barHeight:1,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,fillParent:!0,height:128,hideScrollbar:!1,interact:!0,maxCanvasWidth:4e3,minPxPerSec:20,partialRender:!1,pixelRatio:window.devicePixelRatio,plugins:[],progressColor:"#555",renderer:xe,responsive:!1,scrollParent:!1,splitChannels:!1,waveColor:"#999"},a.util=n,a.params=oe({},a.defaultParams,e),a.container="string"===typeof e.container?document.querySelector(a.params.container):a.params.container,!a.container)throw new Error("Container element not found");if(a.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(a.params.maxCanvasWidth%2===1)throw new Error("maxCanvasWidth must be an even number");if(a.tmpEvents=[],a.currentAjax=null,a.drawer=null,"function"!==typeof a.params.renderer)throw new Error("Renderer parameter is invalid");a.Drawer=a.params.renderer,a.initialisedPluginList={},a.isDestroyed=!1,a.isReady=!1,a.progress=0,a.peaks=null;var s=0;return a._onResize=ye.a(function(){s!==a.drawer.wrapper.clientWidth&&(s=a.drawer.wrapper.clientWidth,a.drawBuffer())},"number"===typeof a.params.responsive?a.params.responsive:100),Object(m.a)(a,Object(y.a)(Object(y.a)(a)))}return Object(f.a)(t,e),Object(h.a)(t,null,[{key:"create",value:function(e){return new t(e).init()}}]),Object(h.a)(t,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach(function(e){return t.addPlugin(e)}),e.forEach(function(e){e.deferInit||t.initPlugin(e.name)}),this.fireEvent("plugins-registered",e),this}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach(function(a){t[a]=e.staticProps[a]});var a=e.instance;return Object.getOwnPropertyNames(te.a.prototype).forEach(function(e){a.prototype[e]=te.a.prototype[e]}),this[e.name]=new a(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!==typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach(function(t){return e.destroyPlugin(t)})}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),this.params.responsive&&window.addEventListener("resize",this._onResize,!0),this.drawer.on("redraw",function(){e.drawBuffer(),e.drawer.progress(e.progress)}),this.drawer.on("click",function(t,a){e.seekTo(a),e.fireEvent("click",a)}),this.drawer.on("scroll",function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)})}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;this.fireEvent("interaction",function(){return t.seekTo(e)});var a=this.params.scrollParent;this.params.scrollParent=!1,this.drawer.progress(e),this.params.scrollParent=a,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.seekTo(0),this.drawer.progress(0)}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"drawBuffer",value:function(){var e=this.drawer.getWidth(),t=e,a=t,n=this.drawer.getScrollX(),s=Math.min(n+e,a);this.params.fillParent&&(!this.params.scrollParent||t<e)&&(n=0,s=a=e),n=0,s=a,this.drawer.drawPeaks(this.peaks,a,n,s),this.fireEvent("redraw",this.peaks,a)}},{key:"zoom",value:function(e){this.params.minPxPerSec=e,this.params.scrollParent=!0,this.drawBuffer(),this.drawer.progress(this.progress),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"getWidth",value:function(){this.drawer.getWidth()}},{key:"load",value:function(e){return this.empty(),this.loadPeaks(e)}},{key:"loadPeaks",value:function(e){"string"===typeof e?this.getPeaksArray(e,this.havePeaks.bind(this)):e instanceof Array&&this.havePeaks(e)}},{key:"havePeaks",value:function(e){this.peaks=e,this.drawBuffer(),this.fireEvent("ready")}},{key:"getPeaksArray",value:function(e,t){var a=this,n=ae({url:e,responseType:"json"});return this.currentAjax=n,this.tmpEvents.push(n.on("success",function(e,n){t(e),a.currentAjax=null}),n.on("error",function(e){a.fireEvent("error","XHR error: "+e.target.statusText),a.currentAjax=null})),n}},{key:"exportImage",value:function(e,t){return e||(e="image/png"),t||(t=1),this.drawer.getImage(e,t)}},{key:"cancelAjax",value:function(){this.currentAjax&&(this.currentAjax.xhr.abort(),this.currentAjax=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(e){return e.un()})}},{key:"empty",value:function(){this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),this.params.responsive&&window.removeEventListener("resize",this._onResize,!0),this.drawer.destroy(),this.isDestroyed=!0,this.peaks=null}}]),t}(te.a);Fe.util=n;var De=["error","loading","mouseup","pause","ready","scroll","seek","zoom"];var Te=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isReady:!1,pos:0},a.loadPeaks=a.loadPeaks.bind(Object(y.a)(Object(y.a)(a))),a.seekTo=a.seekTo.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e,t=this,a=Object.assign({},this.props.options,Object(v.a)({},this.props,{container:this.waveformdrawerEl}));this._waveformdrawer=new Fe(a),this._waveformdrawer.init(),this.props.responsive&&(this._handleResize=(e=function(){t.props.playing&&t._waveformdrawer.pause(),t._waveformdrawer.drawBuffer(),t.state.isReady&&t.seekTo(t.props.pos),t.props.playing&&t._waveformdrawer.play()},function(){var t;t||(t=setTimeout(function(){t=null,e()},66))})),this._waveformdrawer.on("ready",function(){t.setState({isReady:!0,pos:t.props.pos}),t.props.pos&&t.seekTo(t.props.pos),t.props.zoom&&t._waveformdrawer.zoom(t.props.zoom)}),this._waveformdrawer.on("click",function(e){t.props.onPosChange(e)}),De.forEach(function(e){var a,n=t.props["on".concat((a=e,a.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join("")))],s=t._waveformdrawer;n&&t._waveformdrawer.on(e,function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n({waveformdrawer:s,originalArgs:t})})}),this.props.peaks&&this.loadPeaks(this.props.peaks),this.props.responsive&&window.addEventListener("resize",this._handleResize,!1)}},{key:"componentWillReceiveProps",value:function(e){var t,a=this,n=!1;this.props.peaks!==e.peaks&&(this.setState({isReady:!1}),this.loadPeaks(e.peaks),n=!0),void 0!==e.pos&&this.state.isReady&&e.pos!==this.props.pos&&e.pos!==this.state.pos&&(n?t=this._waveformdrawer.on("ready",function(){a.seekTo(e.pos),t.un()}):this.seekTo(e.pos)),this.props.zoom!==e.zoom&&this._waveformdrawer.zoom(e.zoom),e.responsive&&this.props.responsive!==e.responsive&&window.addEventListener("resize",this._handleResize,!1),e.responsive||this.props.responsive===e.responsive||window.removeEventListener("resize",this._handleResize)}},{key:"componentWillUnmount",value:function(){var e=this;De.forEach(function(t){e._waveformdrawer.un(t)}),this._waveformdrawer.destroy(),this.props.responsive&&window.removeEventListener("resize",this._handleResize)}},{key:"pixToPos",value:function(e){return 1/this._waveformdrawer.getWidth()*e}},{key:"posToPix",value:function(e){return e*this._waveformdrawer.getWidth()}},{key:"seekTo",value:function(e){this.props.options.autoCenter?this._waveformdrawer.seekAndCenter(e):this._waveformdrawer.seekTo(e)}},{key:"loadPeaks",value:function(e){if(!("string"===typeof e||e instanceof Array))throw new Error("Waveform.loadPeaks expects prop peaks\n        to be either string or array");this._waveformdrawer.load(e)}},{key:"render",value:function(){var e=this,t=!!this.props.children&&i.a.Children.map(this.props.children,function(t){return i.a.cloneElement(t,{waveformdrawer:e._waveformdrawer,isReady:e.state.isReady})});return i.a.createElement("div",null,i.a.createElement("div",{ref:function(t){e.waveformdrawerEl=t}}),t)}}]),t}(s.Component);Te.defaultProps={playing:!1,pos:0,options:Fe.defaultParams,responsive:!0,onPosChange:function(){}};var Ae=Te,Ue=function(e){function t(e){var a;if(Object(d.a)(this,t),!(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).props.sound)throw new Error("No sound property passed");a.auth=a.props.auth,a.soundengine=a.props.soundengine,a.playlist=a.props.playlist;var n=a.playlist.checkVoted(a.props.sound,a.auth.getAuthUser()),s=a.props.sound.upvotes,i=a.playlist.checkFlagged(a.props.sound,a.auth.getAuthUser());return a.state={voting:!1,reposting:!1,flagging:!1,voted:n,votes:s,reposted:!1,flagged:i,playing:!1,pos:0},a.handleSoundEnginePause=a.handleSoundEnginePause.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEnginePlay=a.handleSoundEnginePlay.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEngineProgress=a.handleSoundEngineProgress.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEngineFinish=a.handleSoundEngineFinish.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistPlaySound=a.handlePlaylistPlaySound.bind(Object(y.a)(Object(y.a)(a))),a.toggleVote=a.toggleVote.bind(Object(y.a)(Object(y.a)(a))),a.handleRepost=a.handleRepost.bind(Object(y.a)(Object(y.a)(a))),a.toggleFlag=a.toggleFlag.bind(Object(y.a)(Object(y.a)(a))),a.playToggle=a.playToggle.bind(Object(y.a)(Object(y.a)(a))),a.clickWaveform=a.clickWaveform.bind(Object(y.a)(Object(y.a)(a))),a.clickVote=a.clickVote.bind(Object(y.a)(Object(y.a)(a))),a.clickRepost=a.clickRepost.bind(Object(y.a)(Object(y.a)(a))),a.clickDownload=a.clickDownload.bind(Object(y.a)(Object(y.a)(a))),a.clickBuy=a.clickBuy.bind(Object(y.a)(Object(y.a)(a))),a.clickFlag=a.clickFlag.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleSoundEnginePlay",value:function(){var e=this.playlist.getCurrentSound(),t=e&&e.author===this.props.sound.author&&e.permlink===this.props.sound.permlink;this.setState({playing:t}),t&&this.soundengine.on("audioprocess",this.handleSoundEngineProgress)}},{key:"handleSoundEnginePause",value:function(){this.setState({playing:!1}),this.soundengine.un("audioprocess",this.handleSoundEngineProgress)}},{key:"handleSoundEngineProgress",value:function(e,t){var a=e/t;this.state.pos!==a&&this.setState({pos:a})}},{key:"handleSoundEngineFinish",value:function(){this.state.playing&&this.setState({playing:!1,pos:0})}},{key:"handlePlaylistPlaySound",value:function(e){var t=this.props.sound===e;this.setState({playing:t})}},{key:"toggleVote",value:function(e){if(e.id===this.props.sound.id){var t=!this.state.voted,a=t?this.state.votes+1:this.state.votes-1;this.setState({voting:!1,voted:t,votes:a})}}},{key:"handleRepost",value:function(e){if(e.id===this.props.sound.id){this.setState({reposting:!1,reposted:!0})}}},{key:"toggleFlag",value:function(e){if(e.id===this.props.sound.id){var t=!this.state.flagged;this.setState({flagging:!1,flagged:t})}}},{key:"playToggle",value:function(){this.soundengine.initIfNeeded();var e=this.playlist.getCurrentSound();e&&e.author===this.props.sound.author&&e.permlink===this.props.sound.permlink?this.state.playing?this.soundengine.pause():this.soundengine.play():(this.playlist.playSound(this.props.sound,this.state.pos),this.soundengine.load(this.playlist.getIpfsUrl(this.props.sound.metadata.audio.files.sound,this.props.sound)))}},{key:"clickWaveform",value:function(e){this.soundengine.initIfNeeded();var t=this.playlist.getCurrentSound();t&&t.author===this.props.sound.author&&t.permlink===this.props.sound.permlink?(this.soundengine.seekTo(e),this.state.playing||this.soundengine.play()):(this.playlist.playSound(this.props.sound,e),this.soundengine.load(this.playlist.getIpfsUrl(this.props.sound.metadata.audio.files.sound,this.props.sound)))}},{key:"clickVote",value:function(){this.state.voting||(this.playlist.voteSound(this.props.sound,!this.state.voted),this.setState({voting:!0}))}},{key:"clickRepost",value:function(){this.state.reposting||this.state.reposted||(this.playlist.repostSound(this.props.sound),this.setState({reposting:!0}))}},{key:"clickDownload",value:function(){var e=this.props.sound.metadata.audio.dlgate;e&&e.length>0?window.open(e,"_blank"):ge(this.playlist.getIpfsUrl(this.props.sound.metadata.audio.files.sound,this.props.sound),this.props.sound.metadata.audio.title)}},{key:"clickBuy",value:function(){var e=this.props.sound.metadata.audio.buyurl;e&&e.length>0&&window.open(e,"_blank")}},{key:"clickFlag",value:function(){this.state.flagging||(this.playlist.flagSound(this.props.sound,!this.state.flagged),this.setState({flagging:!0}))}},{key:"componentDidMount",value:function(){this.soundengine.on("play",this.handleSoundEnginePlay),this.soundengine.on("pause",this.handleSoundEnginePause),this.soundengine.on("finish",this.handleSoundEngineFinish);var e=this.playlist.getCurrentSound();if(e&&e.author===this.props.sound.author&&e.permlink===this.props.sound.permlink){var t=this.soundengine.getCurrentPos(),a=this.soundengine.isPlaying();a&&this.soundengine.on("audioprocess",this.handleSoundEngineProgress),this.setState({playing:a,pos:t})}this.playlist.on("play-sound",this.handlePlaylistPlaySound),this.playlist.on("voted",this.toggleVote),this.playlist.on("reposted",this.handleRepost),this.playlist.on("flagged",this.toggleFlag)}},{key:"componentWillUnmount",value:function(){this.soundengine.un("play",this.handleSoundEnginePlay),this.soundengine.un("pause",this.handleSoundEnginePause),this.soundengine.un("finish",this.handleSoundEngineFinish),this.soundengine.un("audioprocess",this.handleSoundEngineProgress),this.playlist.un("play-sound",this.handlePlaylistPlaySound),this.playlist.un("voted",this.toggleVote),this.playlist.un("reposted",this.handleRepost),this.playlist.un("flagged",this.toggleFlag)}},{key:"render",value:function(){var e,t=this,a=this.auth.getAuthUser(),n=this.props.sound.metadata.audio.type||this.props.sound.metadata.sound.type,s=this.props.sound.metadata.audio.genre||this.props.sound.metadata.sound.genre,o=0,r=[n,s].map(function(e){return i.a.createElement(J.a,{key:o++,to:t.playlist.getCategoryLink(e.substring(0,20))},i.a.createElement(A.a,{className:"track-player-tag"},"#",e.substring(0,20)))}),l=this.state.playing?i.a.createElement("i",{className:"fa fa-pause fa-lg",style:{marginLeft:0}}):i.a.createElement("i",{className:"fa fa-play fa-lg"});e=this.props.sound.metadata.audio.files.cover&&this.props.sound.metadata.audio.files.cover.length>0?i.a.createElement("div",{className:"cover-image",style:{backgroundImage:"url("+this.playlist.getIpfsUrl(this.props.sound.metadata.audio.files.cover,this.props.sound)+")"}}):i.a.createElement("div",{className:"cover-image"});var c,u,d,h,m,p,f=this.props.sound?"/@"+this.props.sound.author:"",g=this.props.sound?"/@"+this.props.sound.author+"/"+this.props.sound.permlink:"";return this.props.sound.metadata.audio.duration&&(c=i.a.createElement("span",{className:"player-duration"},_.time(this.props.sound.metadata.audio.duration))),a?(u=this.state.voted?i.a.createElement("button",{onClick:this.clickVote,className:"bottom-player-btn active"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)):i.a.createElement("button",{onClick:this.clickVote,className:"bottom-player-btn"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)),a.name!==this.props.sound.author&&0===this.props.sound.author_rewards&&(d=this.state.reposted?i.a.createElement("button",{onClick:this.clickRepost,className:"bottom-player-btn active"},i.a.createElement("i",{className:"fa fa-retweet"})):i.a.createElement("button",{onClick:this.clickRepost,className:"bottom-player-btn"},i.a.createElement("i",{className:"fa fa-retweet"}))),h=this.state.flagged?i.a.createElement("button",{onClick:this.clickFlag,className:"bottom-flag-btn active"},i.a.createElement("i",{className:"fa fa-flag-o"})):i.a.createElement("button",{onClick:this.clickFlag,className:"bottom-flag-btn"},i.a.createElement("i",{className:"fa fa-flag-o"}))):(u=i.a.createElement("button",{className:"bottom-player-btn disabled"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)),0===this.props.sound.author_rewards&&(d=i.a.createElement("button",{className:"bottom-player-btn disabled"},i.a.createElement("i",{className:"fa fa-retweet"}))),h=i.a.createElement("button",{className:"bottom-flag-btn disabled"},i.a.createElement("i",{className:"fa fa-flag-o"}))),this.props.sound.metadata.audio.download?m=i.a.createElement("button",{onClick:this.clickDownload,className:"bottom-player-btn d-md-down-none"},i.a.createElement("i",{className:"fa fa-download"})," Download"):this.props.sound.metadata.audio.buy&&(m=i.a.createElement("button",{onClick:this.clickBuy,className:"bottom-player-btn d-md-down-none"},i.a.createElement("i",{className:"fa fa-shopping-basket"})," Buy")),p=0!==parseFloat(this.props.sound.pending_payout_value)?this.props.sound.pending_payout_value:this.props.sound.total_payout_value,i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("article",{className:"track-player"},i.a.createElement(J.a,{to:g},e),i.a.createElement("div",{className:"player-area"},i.a.createElement("div",{className:"top-player-area"},i.a.createElement("button",{className:"track-player-play",onClick:this.playToggle},l),i.a.createElement("div",{className:"track-player-sound"},i.a.createElement("div",{className:"track-player-author"},i.a.createElement(J.a,{to:f},"@"+this.props.sound.author),i.a.createElement("span",{className:"from-now"},_.dateFromNow(this.props.sound.created))),i.a.createElement("div",{className:"track-player-title"},i.a.createElement(J.a,{to:g},this.props.sound.metadata.audio.title.substring(0,100)),c)),i.a.createElement("div",{className:"track-player-tags"},r)),i.a.createElement("div",{className:"track-player-wave"},i.a.createElement(Ae,{peaks:this.playlist.getIpfsUrl(this.props.sound.metadata.audio.files.peaks,this.props.sound),pos:this.state.pos,onPosChange:this.clickWaveform,options:{barWidth:2,progressColor:"#f49b0b",cursorColor:"rgba(0,0,0,0.0)"}})),i.a.createElement("div",{className:"bottom-player-area"},u,d,m,i.a.createElement("div",{className:"bottom-player-info"},"$"+_.sbd(p),i.a.createElement("i",{className:"fa fa-comments"})," ",_.number(this.props.sound.children),h))))))}}]),t}(s.Component),Le=a(29),Re=a.n(Le),Ie=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.soundengine=a.props.soundengine,a.playlist=a.props.playlist;var n=a.props.query;return a.state={waitingForSounds:!0,atTheEnd:!1,query:n,sounds:[],current:null},a.handlePlaylistSounds=a.handlePlaylistSounds.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistNextSounds=a.handlePlaylistNextSounds.bind(Object(y.a)(Object(y.a)(a))),a.handleScroll=a.handleScroll.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleScroll",value:function(){this.state.atTheEnd||this.state.waitingForSounds||(void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop)+Math.max(document.documentElement.clientHeight,window.innerHeight||0)>document.body.clientHeight-100&&(this.playlist.getNextSoundsList(),this.setState({waitingForSounds:!0}))}},{key:"handlePlaylistSounds",value:function(e){var t=[].concat(e);this.setState({sounds:t,atTheEnd:0===t.length,waitingForSounds:!1})}},{key:"handlePlaylistNextSounds",value:function(e){if(0!==e.length){var t=[];t.push.apply(t,Object(Pe.a)(this.state.sounds).concat(Object(Pe.a)(e))),this.setState({sounds:t,waitingForSounds:!1})}else this.setState({atTheEnd:!0})}},{key:"componentDidMount",value:function(){switch(this.state.query){default:case"feed":document.title="DSound - Decentralized Sound Platform";break;case"trending":document.title="Trending Sounds | DSound - Decentralized Sound Platform";break;case"hot":document.title="Hot Sounds | DSound - Decentralized Sound Platform";break;case"new":document.title="New Sounds | DSound - Decentralized Sound Platform"}window.addEventListener("scroll",this.handleScroll),this.playlist.on("sounds",this.handlePlaylistSounds),this.playlist.on("next-sounds",this.handlePlaylistNextSounds),this.playlist.getSoundsList(this.state.query,this.props.match.params)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll),this.playlist.un("sounds",this.handlePlaylistSounds),this.playlist.un("next-sounds",this.handlePlaylistNextSounds)}},{key:"getTrackPlayer",value:function(e){return i.a.createElement(Ue,{key:e.id,auth:this.auth,soundengine:this.soundengine,playlist:this.playlist,sound:e})}},{key:"render",value:function(){var e,t,a=this;if(this.props.match.params.category&&(e=i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"category-top"},i.a.createElement(A.a,{className:"category-tag"},"#",this.props.match.params.category)))),t=this.state.atTheEnd?i.a.createElement("div",{className:"feed-footer"},i.a.createElement("p",{className:"engraved"},"Reached the end of the Internet... Upload your sounds to make it bigger! :)"),i.a.createElement("i",{className:"fa fa-ellipsis-h fa-lg"}),i.a.createElement("p",null,i.a.createElement("span",{className:"footer-quote"},"Music is what feelings sound like!"),i.a.createElement("br",null),"DSound ",i.a.createElement("i",{className:"heart fa fa-heart-o"})," music")):i.a.createElement("div",{className:"feed-load-more"},i.a.createElement("img",{className:"orange-load-mini",src:Re.a,alt:""})),this.state.sounds.length>0){var n=this.state.sounds.map(function(e){return a.getTrackPlayer(e)});return i.a.createElement("section",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"main-page col-sm-12 fill"},e,n)),t)}return this.state.waitingForSounds?i.a.createElement("div",{className:"loading animated fadeIn fadeOut"},i.a.createElement("img",{className:"orange-load",src:Re.a,alt:""})):i.a.createElement("div",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"main-page col-sm-12 fill empty-feed"},i.a.createElement("p",{className:"spread"},"Oops! Looks like no one spread ",i.a.createElement("i",{className:"heart fa fa-heart"})," for a while..."),i.a.createElement("p",{className:"ask"},"Ask your friends to share some sounds with the world..."),i.a.createElement("i",{className:"fa fa-ellipsis-h fa-lg"}),i.a.createElement("p",null,i.a.createElement("span",{className:"footer-quote"},"Music is what feelings sound like!"),i.a.createElement("br",null),"DSound ",i.a.createElement("i",{className:"heart fa fa-heart-o"})," music"))))}}]),t}(s.Component),_e=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.steem=a.props.steem,a.soundengine=a.props.soundengine,a.playlist=a.props.playlist,a.author=a.props.match.params.user,a.state={author:null,waitingForSounds:!0,atTheEnd:!1,sounds:[],current:null},a.onProfilePictureError=a.onProfilePictureError.bind(Object(y.a)(Object(y.a)(a))),a.clickFollow=a.clickFollow.bind(Object(y.a)(Object(y.a)(a))),a.clickUnfollow=a.clickUnfollow.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistSounds=a.handlePlaylistSounds.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistNextSounds=a.handlePlaylistNextSounds.bind(Object(y.a)(Object(y.a)(a))),a.handleScroll=a.handleScroll.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"onProfilePictureError",value:function(e){e.target.src=G.a}},{key:"clickFollow",value:function(){var e=this;this.author&&!this.state.ongoingFollow&&(this.setState({ongoingFollow:!0}),this.steem.followUser(this.author).then(function(t){e.setState({ongoingFollow:!1,following:!0,follows:Object(v.a)({},e.state.follows,{follower_count:e.state.follows.follower_count+1})})}).catch(function(e){console.log("Error following:",e)}))}},{key:"clickUnfollow",value:function(){var e=this;this.author&&!this.state.ongoingFollow&&(this.setState({ongoingFollow:!0}),this.steem.unfollowUser(this.author).then(function(t){e.setState({ongoingFollow:!1,following:!1,follows:Object(v.a)({},e.state.follows,{follower_count:e.state.follows.follower_count-1})})}).catch(function(e){console.log("Error unfollowing:",e)}))}},{key:"handleScroll",value:function(){this.state.atTheEnd||this.state.waitingForSounds||(void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop)+Math.max(document.documentElement.clientHeight,window.innerHeight||0)>document.body.clientHeight-100&&(this.playlist.getNextSoundsList(),this.setState({waitingForSounds:!0}))}},{key:"handlePlaylistSounds",value:function(e){this.setState({sounds:e,atTheEnd:0===e.length,waitingForSounds:!1})}},{key:"handlePlaylistNextSounds",value:function(e){if(0!==e.length){var t=[];t.push.apply(t,Object(Pe.a)(this.state.sounds).concat(Object(Pe.a)(e))),this.setState({sounds:t,waitingForSounds:!1})}else this.setState({atTheEnd:!0})}},{key:"componentDidMount",value:function(){var e=this,t=this.auth.getAuthUser(),a=[];a.push(this.steem.getUserMetadata(this.author)),a.push(this.steem.getUserFollowCount(this.author)),t&&a.push(this.steem.getUserFollowing(t.name)),Promise.all(a).then(function(a){var n=a[0],s=a[1],i=!1,o=n.profile.name&&n.profile.name!==n.name?n.profile.name:"@"+n.name;if(document.title=o+" Sounds | DSound - Decentralized Sound Platform",t){var r=a[2];r&&(i=void 0!==r.find(function(e){return e.following===n.name}))}e.setState({author:n,follows:s,following:i})}).catch(function(e){console.log("Error getting user data:",e)}),window.addEventListener("scroll",this.handleScroll),this.playlist.on("sounds",this.handlePlaylistSounds),this.playlist.on("next-sounds",this.handlePlaylistNextSounds),this.playlist.getSoundsList("user",this.props.match.params)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll),this.playlist.un("sounds",this.handlePlaylistSounds),this.playlist.un("next-sounds",this.handlePlaylistNextSounds)}},{key:"getTrackPlayer",value:function(e){return i.a.createElement(Ue,{key:e.id,auth:this.auth,soundengine:this.soundengine,playlist:this.playlist,sound:e})}},{key:"render",value:function(){var e,t,a,n,s,o,r,l,c,u=this,d=this.auth.getAuthUser();if(this.state.author&&this.state.author.profile?(this.state.author.profile.profile_image&&(e=this.state.author.profile.profile_image),this.state.author.profile.cover_image&&(t=this.state.author.profile.cover_image)):(e=G.a,t=null),this.state.author&&(a=this.state.author.profile&&this.state.author.profile.name&&this.state.author.profile.name!==this.state.author.name?i.a.createElement("div",{className:"user-name-area"},i.a.createElement("div",{className:"user-name"},this.state.author.profile.name),i.a.createElement("div",{className:"user-nickname"},"@",this.state.author.name)):i.a.createElement("div",{className:"user-name-area"},i.a.createElement("div",{className:"user-name"},"@",this.state.author.name)),this.state.author.profile&&this.state.author.profile.location&&(n=i.a.createElement("div",{className:"user-location"},this.state.author.profile.location)),this.state.author.profile&&this.state.author.profile.website?s=i.a.createElement("div",{className:"user-website"},i.a.createElement("a",{href:this.state.author.profile.website,target:"_blank",rel:"noopener noreferrer"},i.a.createElement("i",{className:"fa fa-external-link"})," Website")):this.state.author.profile&&this.state.author.profile.about&&(s=i.a.createElement("div",{className:"user-website"})),this.state.author.profile&&this.state.author.profile.about&&(o=i.a.createElement("div",{className:"user-about"},this.state.author.profile.about))),this.state.follows&&(r=i.a.createElement("div",{className:"user-follows"},i.a.createElement("span",{className:"followers"},i.a.createElement("i",{className:"fa fa-users"}),_.number(this.state.follows.follower_count)),i.a.createElement("span",{className:"following"},i.a.createElement("i",{className:"fa fa-user"}),_.number(this.state.follows.following_count)))),d&&this.state.author&&this.state.author.name!==d.name&&(l=this.state.following?i.a.createElement("button",{onClick:this.clickUnfollow,className:"btn-follow-unfollow"},i.a.createElement("i",{className:"fa fa-user-times"})," Unfollow"):i.a.createElement("button",{onClick:this.clickFollow,className:"btn-follow-unfollow"},i.a.createElement("i",{className:"fa fa-user-plus"})," Follow")),c=this.state.atTheEnd?i.a.createElement("div",{className:"feed-footer"},i.a.createElement("p",{className:"engraved"},"Reached the end of the Internet... Upload your sounds to make it bigger! :)"),i.a.createElement("i",{className:"fa fa-ellipsis-h fa-lg"}),i.a.createElement("p",null,i.a.createElement("span",{className:"footer-quote"},"Music is what feelings sound like!"),i.a.createElement("br",null),"DSound ",i.a.createElement("i",{className:"heart fa fa-heart-o"})," music")):i.a.createElement("div",{className:"feed-load-more"},i.a.createElement("img",{className:"orange-load-mini",src:Re.a,alt:""})),this.state.sounds.length>0){var h=this.state.sounds.map(function(e){return u.getTrackPlayer(e)});return i.a.createElement("section",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"user-page fill"},i.a.createElement("div",{className:"user-page-top",style:{backgroundImage:t?"url("+t+")":"linear-gradient(135deg,#406060,#70929c)"}},i.a.createElement("img",{src:e,className:"user-picture",alt:"",onError:this.onProfilePictureError}),i.a.createElement("div",{className:"user-data"},a,n),i.a.createElement("div",{className:"user-extra d-md-down-none"},s,o)),i.a.createElement("div",{className:"user-page-actions"},r,l),i.a.createElement("div",{className:"main-page col-sm-12"},h))),c)}return this.state.waitingForSounds?i.a.createElement("div",{className:"loading animated fadeIn fadeOut"},i.a.createElement("img",{className:"orange-load",src:Re.a,alt:""})):i.a.createElement("div",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"user-page fill"},i.a.createElement("div",{className:"user-page-top",style:{backgroundImage:t?"url("+t+")":"linear-gradient(135deg,#406060,#70929c)"}},i.a.createElement("img",{src:e,className:"user-picture",alt:"",onError:this.onProfilePictureError}),i.a.createElement("div",{className:"user-data"},a,n),i.a.createElement("div",{className:"user-extra d-md-down-none"},s,o)),i.a.createElement("div",{className:"user-page-actions"},r,l),i.a.createElement("div",{className:"main-page col-sm-12"},h),i.a.createElement("div",{className:"main-page col-sm-12 empty-feed"},i.a.createElement("p",{className:"spread"},"Oops! Looks like ",this.props.match.params.user===d.name?"you":"@"+this.props.match.params.user," didn","'","t spread ",i.a.createElement("i",{className:"heart fa fa-heart"})," for a while..."),i.a.createElement("p",{className:"ask"},this.props.match.params.user===d.name?"Just click on upload above and share your sounds...":"Ask your friend to share his sounds with us..."),i.a.createElement("i",{className:"fa fa-ellipsis-h fa-lg"}),i.a.createElement("p",null,i.a.createElement("span",{className:"footer-quote"},"Music is what feelings sound like!"),i.a.createElement("br",null),"DSound ",i.a.createElement("i",{className:"heart fa fa-heart-o"})," music")))))}}]),t}(s.Component),Me=a(61),Be=a.n(Me),We=a(34),ze=a.n(We),Ve=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).onPlay=function(){e.setState({play:!0})},e.state={},e}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.youTubeId,a=e.width,n=e.height,s=e.dataParams;if(!this.state.play){var o=a<=320?"mqdefault.jpg":a<=480?"hqdefault.jpg":"0.jpg",r="https://img.youtube.com/vi/".concat(t,"/").concat(o);return i.a.createElement("div",{className:"videoWrapper youtube",onClick:this.onPlay,style:{backgroundImage:"url("+r+")"}},i.a.createElement("div",{className:"play"}))}var l="https://www.youtube.com/embed/".concat(t,"?autoplay=1&autohide=1&").concat(s);return i.a.createElement("div",{className:"videoWrapper"},i.a.createElement("iframe",{width:a,height:n,src:l,frameBorder:"0",allowFullScreen:"true",title:"video placeholder"}))}}]),t}(i.a.Component);Ve.defaultProps={width:640,height:360,dataParams:"enablejsapi=0&rel=0&origin=https://steemit.com"};var Ge=function(e){return e.replace(/&[a-z]+;/g,function(e){var t=qe[e.substring(1,e.length-1)];return t||e})},qe={amp:"&",quot:'"',lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",hearts:"\u2665",trade:"\u2122",hellip:"\u2026",pound:"\xa3",copy:""},He=a(111),Je=a.n(He),Ze='[^\\s"<>\\]\\[\\(\\)]'.replace(/\]$/,".,']"),$e="(?:(?:\\.(?:tiff?|jpe?g|gif|png|svg|ico)|ipfs/[a-z\\d]{40,}))",Qe="(?:[-a-zA-Z0-9\\._]*[-a-zA-Z0-9])",Ke='(?:[^\\s"<>\\]\\[\\(\\)]*'+Ze+")?",Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.domain,a=void 0===t?Qe:t,n=e.path;return"https?://".concat(a,"(?::\\d{2,5})?(?:[/\\?#]").concat(Ke).concat(n||"",")").concat(n?"":"?")},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp(Xe(),e)},et={any:Ye(),local:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp(Xe({domain:"(?:localhost|(?:.*\\.)?steemit.com)"}),e)}(),remote:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp(Xe({domain:"(?!localhost|(?:.*\\.)?steemit.com)".concat(Qe)}),e)}(),image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp(Xe({path:$e}),e)}(),imageFile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp($e,e)}(),youTube:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"i";return new RegExp(Xe({domain:"(?:(?:.*.)?youtube.com|youtu.be)"}),e)}(),youTubeId:/(?:(?:youtube.com\/watch\?v=)|(?:youtu.be\/)|(?:youtube.com\/embed\/))([A-Za-z0-9_-]+)/i,vimeo:/https?:\/\/(?:vimeo.com\/|player.vimeo.com\/video\/)([0-9]+)\/*/,vimeoId:/(?:vimeo.com\/|player.vimeo.com\/video\/)([0-9]+)/,ipfsPrefix:/(https?:\/\/.*)?\/ipfs/i},tt=["dsonnd.audio","dsouud.audio","dsonud.audio","d\u015bound.audio","d\u015dound.audio","d\u015found.audio","d\u0161ound.audio","d\u0219ound.audio","dsou\xf1d.audio","steewit.com","\u015bteemit.com","\u015dteemit.com","\u015fteemit.com","\u0161teemit.com","s\u0163eemit.com","s\u0165eemit.com","\u0219teemit.com","sleemit.com","aba.ae","autobidbot.cf","autobidbot.ga","autobidbot.gq","autobotsteem.cf","autobotsteem.ga","autobotsteem.gq","autobotsteem.ml","autosteem.info","autosteembot.cf","autosteembot.ga","autosteembot.gq","autosteembot.ml","autosteemit.wapka.mobi","boostbot.ga","boostbot.gq","boostwhaleup.cf","cutt.us","dereferer.me","eb2a.com","lordlinkers.tk","nullrefer.com","steeemit.ml","steeemitt.aba.ae","steemart.ga","steemautobot.bid","steemautobot.cf","steemautobot.trade","steemers.aba.ae","steemiit.cf","steemiit.ga","steemij.tk","steemik.ga","steemik.tk","steemil.com","steemil.ml","steemir.tk","steemitservices.ga","steemitservices.gq","steemnow.cf","steemnow.ga","steemnow.gq","steemnow.ml","steempostupper.win","steemrewards.ml","steemrobot.ga","steemrobot.ml","steemupgot.cf","steemupgot.ga","steemupgot.gq","steemupper.cf","steemupper.ga","steemupper.gq","steemupper.ml","steenit.cf","stemit.com","stssmater.aba.ae","uppervotes.ga","uppervotes.gq","upperwhaleplus.cf","upperwhaleplus.ga","upperwhaleplus.gq","upvoteme.cf","upvoteme.ga","upvoteme.gq","upvoteme.ml","url.rw","us.aba.ae","whaleboostup.ga","whaleboostup.ml"],at=function(e){for(var t=0;t<tt.length;t++){var a=tt[t];if(e.toLocaleLowerCase().indexOf(a)>-1)return!0}return!1},nt=function(){return"This is kind of phishy, be careful..."},st="https://ipfs.io/",it=function(){},ot=new Je.a.DOMParser({errorHandler:{warning:it,error:it}}),rt=new Je.a.XMLSerializer,lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.mutate,n=void 0===a||a,s=t.hideImages,i=void 0!==s&&s,o={mutate:n};o.hashtags=new Set,o.usertags=new Set,o.htmltags=new Set,o.images=new Set,o.links=new Set;try{var r=ot.parseFromString(e,"text/html");if(function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.childNodes)return;Array.from(t.childNodes).forEach(function(t){var s=t.tagName?t.tagName.toLowerCase():null;s&&a.htmltags.add(s),"img"===s?function(e,t){var a=t.getAttribute("src");if(a&&(e.images.add(a),e.mutate)){var n=ut(a);/^\/\//.test(n)&&(n="https:"+n),n!==a&&t.setAttribute("src",n)}}(a,t):"iframe"===s?function(e,t){var a=t.getAttribute("src");if(a){var n=e.images,s=e.links,i=ct(a);i&&n&&s&&(s.add(i.url),n.add("https://img.youtube.com/vi/"+i.id+"/0.jpg"))}if(!e.mutate)return;if("div"===(t.parentNode.tagName?t.parentNode.tagName.toLowerCase():t.parentNode.tagName)&&"videoWrapper"===t.parentNode.getAttribute("class"))return;var o=rt.serializeToString(t);t.parentNode.replaceChild(ot.parseFromString('<div class="videoWrapper">'.concat(o,"</div>")),t)}(a,t):"a"===s?function(e,t){var a=t.getAttribute("href");if(a&&(e.links.add(a),e.mutate&&(/^((#)|(\/(?!\/))|(((steem|https?):)?\/\/))/.test(a)||t.setAttribute("href","https://"+a),0!==a.indexOf("#")&&t.textContent.match(/(www\.)?steemit\.com/i)&&!a.match(/https?:\/\/(.*@)?(www\.)?steemit\.com/i)||at(a)))){var n=t.ownerDocument.createElement("div");n.textContent="".concat(t.textContent," / ").concat(a),n.setAttribute("title",nt()),n.setAttribute("class","phishy"),t.parentNode.replaceChild(n,t)}}(a,t):"#text"===t.nodeName&&function(e,t){try{var a=e.parentNode.tagName?e.parentNode.tagName.toLowerCase():e.parentNode.tagName;if("code"===a)return;if("a"===a)return;var n=t.mutate;if(!e.data)return;e=function(e,t){try{var a=e.data,n=function(e){if(!e)return null;var t=e.match(et.vimeo);return!t||t.length<2?null:{id:t[1],url:t[0],canonical:"https://player.vimeo.com/video/".concat(t[1])}}(a);if(!n)return e;e.data=a.replace(n.url,"~~~ embed:".concat(n.id," vimeo ~~~")),t&&t.add(n.canonical)}catch(s){console.log(s)}return e}(e=function(e,t,a){try{var n=e.data,s=ct(n);if(!s)return e;e.data=n.replace(s.url,"~~~ embed:".concat(s.id," youtube ~~~")),t&&t.add(s.url),a&&a.add(s.thumbnail)}catch(i){console.log(i)}return e}(e,t.links,t.images),t.links,t.images);var s=rt.serializeToString(e),i=function(e,t,a,n,s,i){return e=(e=(e=e.replace(/(^|\s)(#[-a-z\d]+)/gi,function(e){if(/#[\d]+$/.test(e))return e;var n=/^\s/.test(e)?e[0]:"",s=e.trim().substring(1).toLowerCase();return a&&a.add(s),t?n+'<a href="/trending/'.concat(s,'">').concat(e,"</a>"):e})).replace(/(^|[^a-zA-Z0-9_!#$%&*@\uff20\/]|(^|[^a-zA-Z0-9_+~.-\/#]))[@\uff20]([a-z][-.a-z\d]+[a-z\d])/gi,function(e,a,s,i){var o=i.toLowerCase();n&&n.add(o);var r=(a||"")+(s||"");return t?"".concat(r,'<a href="/@').concat(o,'">@').concat(i,"</a>"):"".concat(r).concat(i)})).replace(Ye("gi"),function(e){return et.image.test(e)?(s&&s.add(e),'<img src="'.concat(ut(e),'" />')):/\.(zip|exe)$/i.test(e)?e:at(e)?"<div title='".concat(nt(),"' class='phishy'>").concat(e,"</div>"):(i&&i.add(e),'<a href="'.concat(ut(e),'">').concat(e,"</a>"))})}(s,t.mutate,t.hashtags,t.usertags,t.images,t.links);if(n&&i!==s){var o=ot.parseFromString("<span>".concat(i,"</span>"));e.parentNode.replaceChild(o,e)}}catch(r){console.log(r)}}(t,a),e(t,a,n+1)})}(r,o),n&&i)for(var l=Array.from(r.getElementsByTagName("img")),c=0;c<l.length;c++){var u=l[c],d=r.createElement("pre");d.setAttribute("class","image-url-only"),d.appendChild(r.createTextNode(u.getAttribute("src"))),u.parentNode.replaceChild(d,u)}return n?Object(v.a)({html:r?rt.serializeToString(r):""},o):o}catch(h){return console.log("rendering error",JSON.stringify({error:h.message,html:e})),{html:""}}};function ct(e){if(!e)return null;var t=e.match(et.youTube),a=t?t[0]:null;if(!a)return null;var n=a.match(et.youTubeId),s=n&&n.length>=2?n[1]:null;return s?{id:s,url:a,thumbnail:"https://img.youtube.com/vi/"+s+"/0.jpg"}:null}function ut(e){if(st&&/^\/?\/ipfs\//.test(e)){var t="/"===e.charAt(1)?1:0;return e=e.substring(t+"/ipfs/".length),st+"/"+e}return e}var dt=new Be.a;dt.use(function(e){e.renderer.render=function(t,a,n){for(var s="",i=0;i<t.length;i++)"inline"===t[i].type?s+=e.renderer.render(t[i].children,a,n):s+=(t[i].content||"")+" ";return s}});var ht=[{re:/^(https?:)?\/\/player.vimeo.com\/video\/.*/i,fn:function(e){if(!e)return null;var t=e.match(/https:\/\/player\.vimeo\.com\/video\/([0-9]+)/);return t&&2===t.length?"https://player.vimeo.com/video/"+t[1]:null}},{re:/^(https?:)?\/\/www.youtube.com\/embed\/.*/i,fn:function(e){return e.replace(/\?.+$/,"")}},{re:/^https:\/\/w.soundcloud.com\/player\/.*/i,fn:function(e){if(!e)return null;var t=e.match(/url=(.+?)&/);return t&&2===t.length?"https://w.soundcloud.com/player/?url="+t[1]+"&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&visual=true":null}}],mt="(Image not shown due to low ratings)",pt="\n    div, iframe, del,\n    a, p, b, i, q, br, ul, li, ol, img, h1, h2, h3, h4, h5, h6, hr,\n    blockquote, pre, code, em, strong, center, table, thead, tbody, tr, th, td,\n    strike, sup, sub\n".trim().split(/,\s*/),ft=function(e){var t=e.large,a=void 0===t||t,n=e.highQualityPost,s=void 0===n||n,i=e.noImage,o=void 0!==i&&i,r=e.sanitizeErrors,l=void 0===r?[]:r;return{allowedTags:pt,allowedAttributes:{iframe:["src","width","height","frameborder","allowfullscreen","webkitallowfullscreen","mozallowfullscreen"],div:["class","title"],td:["style"],img:["src","alt"],a:["href","rel","title"]},allowedSchemes:["http","https","steem"],transformTags:{iframe:function(e,t){for(var n=t.src,s=0;s<ht.length;s++){var i=ht[s];if(i.re.test(n)){var o="function"===typeof i.fn?i.fn(n,i.re):n;if(!o)break;return{tagName:"iframe",attribs:{frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",mozallowfullscreen:"mozallowfullscreen",src:o,width:a?"640":"480",height:a?"360":"270"}}}}return console.log('Blocked, did not match iframe "src" white list urls:',e,t),l.push("Invalid iframe URL: "+n),{tagName:"div",text:"(Unsupported ".concat(n,")")}},img:function(e,t){if(o)return{tagName:"div",text:mt};var a=t.src,n=t.alt;if(/^!?\[[^\]]*\]\(([^)]*)\)/.test(a)&&(a=a.replace(/^!?\[[^\]]*\]\(/,"").replace(/\)$/,"")),!/^(https?:)?\/\//i.test(a))return console.log("Blocked, image tag src does not appear to be a url",e,t),l.push("An image in this post did not save properly."),{tagName:"img",attribs:{src:"brokenimg.jpg"}};var s={src:a=a.replace(/^http:\/\//i,"//")};return n&&""!==n&&(s.alt=n),{tagName:e,attribs:s}},div:function(e,t){var a={},n=["pull-right","pull-left","text-justify","text-rtl","text-center","text-right","videoWrapper","phishy"].find(function(e){return t.class===e});return n&&(a.class=n),"phishy"===n&&t.title===nt()&&(a.title=t.title),{tagName:e,attribs:a}},td:function(e,t){var a={};return"text-align:right"===t.style&&(a.style="text-align:right"),{tagName:e,attribs:a}},a:function(e,t){var a=t.href;a||(a="#");var n={href:a=a.trim()};return a.match(/^(\/(?!\/)|https:\/\/steemit.com)/)||(n.rel=s?"noopener":"nofollow noopener",n.title="This will take you to an external website..."),{tagName:e,attribs:n}}}}},gt=new Be.a({html:!0,breaks:!0,linkify:!1,typographer:!1,quotes:"\u201c\u201d\u2018\u2019"}),vt=new Be.a({html:!0,breaks:!1,linkify:!1,typographer:!1,quotes:"\u201c\u201d\u2018\u2019"}),yt=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).onAllowNoImage=function(){e.setState({allowNoImage:!1})},e.state={allowNoImage:!0},e}return Object(f.a)(t,e),Object(h.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.text!==this.props.text||e.large!==this.props.large||e.canEdit!==this.props.canEdit||t.allowNoImage!==this.state.allowNoImage}},{key:"render",value:function(){var e=this.props,t=e.noImage,a=e.hideImages,n=this.state.allowNoImage,s=this.props.text;s||(s="");var o=this.props,r=o.large,l=o.highQualityPost,c=!1,u=s.match(/^<html>([\S\s]*)<\/html>$/);u&&2===u.length?(c=!0,s=u[1]):c=/^<p>[\S\s]*<\/p>/.test(s),s=s.replace(/<!--([\s\S]+?)(-->|$)/g,"(html comment removed: $1)");var d=vt;!0===this.props.breaks&&(d=gt);var h=c?s:d.render(s);0!==!h.indexOf("<html>")&&(h="<html>"+h+"</html>"),h&&(h=lt(h,{hideImages:a}).html);var m=h;if(!0===this.props.allowDangerousHTML?console.log("WARN\tMarkdownViewer rendering unsanitized content"):m=ze()(h,ft({large:r,highQualityPost:l,noImage:t&&n})),/<\s*script/gi.test(m))return console.error("Refusing to render script tag in post text",m),i.a.createElement("div",null);var p=-1!==m.indexOf(mt),f=0,g=[],v=!0,y=!1,b=void 0;try{for(var k,E=m.split("~~~ embed:")[Symbol.iterator]();!(v=(k=E.next()).done);v=!0){var w=k.value,N=w.match(/^([A-Za-z0-9_-]+) (youtube|vimeo) ~~~/);if(N&&N.length>=3){var S=N[1],O=N[2],C=r?640:480,j=r?360:270;if("youtube"===O)g.push(i.a.createElement(Ve,{key:f++,width:C,height:j,youTubeId:S,frameBorder:"0",allowFullScreen:"true"}));else if("vimeo"===O){var P="https://player.vimeo.com/video/".concat(S);g.push(i.a.createElement("div",{className:"videoWrapper"},i.a.createElement("iframe",{key:f++,src:P,width:C,height:j,frameBorder:"0",webkitallowfullscreen:!0,mozallowfullscreen:!0,allowFullScreen:!0,title:"video placeholder"})))}else console.error("MarkdownViewer unknown embed type",O);if(""===(w=w.substring("".concat(S," ").concat(O," ~~~").length)))continue}g.push(i.a.createElement("div",{key:f++,dangerouslySetInnerHTML:{__html:w}}))}}catch(F){y=!0,b=F}finally{try{v||null==E.return||E.return()}finally{if(y)throw b}}var x="Markdown"+(this.props.className?" ".concat(this.props.className):"")+(c?" html":"")+(r?"":" MarkdownViewer--small");return i.a.createElement("div",{className:"MarkdownViewer "+x},g,p&&n&&i.a.createElement("div",{onClick:this.onAllowNoImage,className:"MarkdownViewer__negative_group"},"Images were hidden due to low ratings",i.a.createElement("button",{style:{marginBottom:0},className:"button hollow tiny float-right"},"Show")))}}]),t}(s.Component);yt.defaultProps={allowDangerousHTML:!1,breaks:!0,className:"",hideImages:!1,large:!1};var bt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.steem=a.props.steem,a.state={root:!1,author:null,upVotes:0,downVotes:0,voting:!1,replyOpen:!1,reply:"",children:[]},a.replyRef=i.a.createRef(),a.onProfilePictureError=a.onProfilePictureError.bind(Object(y.a)(Object(y.a)(a))),a.toggleReply=a.toggleReply.bind(Object(y.a)(Object(y.a)(a))),a.onChangeReply=a.onChangeReply.bind(Object(y.a)(Object(y.a)(a))),a.onReplySubmit=a.onReplySubmit.bind(Object(y.a)(Object(y.a)(a))),a.onUpVote=a.onUpVote.bind(Object(y.a)(Object(y.a)(a))),a.onDownVote=a.onDownVote.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"onProfilePictureError",value:function(e){e.target.src=G.a}},{key:"toggleReply",value:function(){var e=!this.state.replyOpen;this.setState({replyOpen:e})}},{key:"onChangeReply",value:function(e){this.setState({reply:e.target.value})}},{key:"onReplySubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.reply,n=ze()(a,ft({large:!1}));this.steem.postComment(this.props.comment,n).then(function(e){t.loadChildren()}).catch(function(e){L.toast.error("Error posting comment. Please check your connection...")}),this.setState({replyOpen:!1,reply:""})}},{key:"onUpVote",value:function(){var e=this;this.state.voting||(this.steem.voteSound(this.props.comment,!0).then(function(t){e.setState({voting:!1,upVotes:e.state.upVotes+1})}).catch(function(t){L.toast.error("Error voting on comment. Please check your connection..."),e.setState({voting:!1})}),this.setState({voting:!0}))}},{key:"onDownVote",value:function(){var e=this;this.state.voting||(this.steem.flagSound(this.props.comment,!0).then(function(t){e.setState({voting:!1,upVotes:e.state.downVotes+1})}).catch(function(t){L.toast.error("Error voting on comment. Please check your connection..."),e.setState({voting:!1})}),this.setState({voting:!0}))}},{key:"loadChildren",value:function(){var e=this;this.steem.getSoundComments(this.props.comment.author,this.props.comment.permlink).then(function(t){e.setState({children:t})}).catch(function(e){console.log("Error updating child comments:",e)})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.comment.author===this.props.comment.root_author&&this.props.comment.permlink===this.props.comment.root_permlink;this.setState({root:t}),t||(this.steem.getCommentData(this.props.comment.author,this.props.comment.permlink).then(function(t){e.setState({upVotes:t.upvotes,downVotes:t.downvotes,comment:t})}),this.steem.getUserMetadata(this.props.comment.author).then(function(t){e.setState({author:t})})),this.props.comment.children>0&&this.loadChildren()}},{key:"componentDidUpdate",value:function(){this.state.replyOpen&&this.replyRef.current&&this.replyRef.current.focus()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e,a,n,s=this;if(!this.state.root){var o=G.a;this.state.author&&this.state.author.profile&&this.state.author.profile.profile_image&&(o=this.state.author.profile.profile_image),e=i.a.createElement("div",{className:"comment-avatar"},i.a.createElement(J.a,{to:"/@"+this.props.comment.author},i.a.createElement("img",{src:o,alt:"",onError:this.onProfilePictureError})))}this.state.root||(n=0!==parseFloat(this.props.comment.pending_payout_value)?this.props.comment.pending_payout_value:this.props.comment.total_payout_value,a=i.a.createElement("div",{className:"comment-main"},i.a.createElement("div",{className:"comment-post-time"},i.a.createElement(J.a,{to:"/@"+this.props.comment.author},"@",this.props.comment.author),i.a.createElement("span",{className:"post-time"}," commented ",_.dateFromNow(this.props.comment.created))),i.a.createElement("div",{className:"comment-body"},i.a.createElement(yt,{text:this.props.comment.body,jsonMetadata:this.props.comment.metadata})),i.a.createElement("div",{className:"comment-actions"},i.a.createElement("button",{onClick:this.onUpVote,className:"action"},i.a.createElement("i",{className:"fa fa-thumbs-up"})," ",_.number(this.state.upVotes)),i.a.createElement("button",{onClick:this.onDownVote,className:"action"},i.a.createElement("i",{className:"fa fa-thumbs-down"})," ",_.number(this.state.downVotes)),i.a.createElement("span",{className:"action"},"$"+_.sbd(n)),i.a.createElement("button",{onClick:this.toggleReply,className:"action reply"},"Reply"))));var r=this.state.children.map(function(e){return i.a.createElement(t,Object.assign({key:e.id},s.props,{comment:e}))});return i.a.createElement("div",{className:"comment-item"},e,i.a.createElement("div",{className:"comment-main"},a,i.a.createElement("div",{className:"comment-reply",style:{display:this.state.root||this.state.replyOpen?"block":"none"}},i.a.createElement(P.a,{onSubmit:this.onReplySubmit},i.a.createElement(x.a,null,i.a.createElement(F.a,{type:"text",name:"reply",innerRef:this.replyRef,onChange:this.onChangeReply,value:this.state.reply,className:"form-reply",placeholder:"Write your comment"})))),r))}}]),t}(s.Component),kt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.steem=a.props.steem,a.soundengine=a.props.soundengine,a.playlist=a.props.playlist,a.author=a.props.match.params.user,a.permlink=a.props.match.params.permlink,a.state={author:null,sound:null,comments:null,loading:!0,voting:!1,reposting:!1,flagging:!1,voted:!1,votes:0,reposted:!1,flagged:!1,playing:!1,pos:0},a.handleSoundEnginePause=a.handleSoundEnginePause.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEnginePlay=a.handleSoundEnginePlay.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEngineProgress=a.handleSoundEngineProgress.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundEngineFinish=a.handleSoundEngineFinish.bind(Object(y.a)(Object(y.a)(a))),a.handlePlaylistPlaySound=a.handlePlaylistPlaySound.bind(Object(y.a)(Object(y.a)(a))),a.toggleVote=a.toggleVote.bind(Object(y.a)(Object(y.a)(a))),a.handleRepost=a.handleRepost.bind(Object(y.a)(Object(y.a)(a))),a.toggleFlag=a.toggleFlag.bind(Object(y.a)(Object(y.a)(a))),a.playToggle=a.playToggle.bind(Object(y.a)(Object(y.a)(a))),a.clickWaveform=a.clickWaveform.bind(Object(y.a)(Object(y.a)(a))),a.clickVote=a.clickVote.bind(Object(y.a)(Object(y.a)(a))),a.clickRepost=a.clickRepost.bind(Object(y.a)(Object(y.a)(a))),a.clickEdit=a.clickEdit.bind(Object(y.a)(Object(y.a)(a))),a.clickDownload=a.clickDownload.bind(Object(y.a)(Object(y.a)(a))),a.clickBuy=a.clickBuy.bind(Object(y.a)(Object(y.a)(a))),a.clickFlag=a.clickFlag.bind(Object(y.a)(Object(y.a)(a))),a.onProfilePictureError=a.onProfilePictureError.bind(Object(y.a)(Object(y.a)(a))),a.clickFollow=a.clickFollow.bind(Object(y.a)(Object(y.a)(a))),a.clickUnfollow=a.clickUnfollow.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleSoundEnginePlay",value:function(){var e=this.playlist.getCurrentSound(),t=e&&e.author===this.state.sound.author&&e.permlink===this.state.sound.permlink;this.setState({playing:t}),t&&this.soundengine.on("audioprocess",this.handleSoundEngineProgress)}},{key:"handleSoundEnginePause",value:function(){this.setState({playing:!1}),this.soundengine.un("audioprocess",this.handleSoundEngineProgress)}},{key:"handleSoundEngineProgress",value:function(e,t){var a=e/t;this.state.pos!==a&&this.setState({pos:a})}},{key:"handleSoundEngineFinish",value:function(){this.state.playing&&this.setState({playing:!1,pos:0})}},{key:"handlePlaylistPlaySound",value:function(e){var t=this.state.sound===e;this.setState({playing:t})}},{key:"toggleVote",value:function(e){if(e.id===this.state.sound.id){var t=!this.state.voted,a=t?this.state.votes+1:this.state.votes-1;this.setState({voting:!1,voted:t,votes:a})}}},{key:"handleRepost",value:function(e){if(e.id===this.state.sound.id){this.setState({reposting:!1,reposted:!0})}}},{key:"toggleFlag",value:function(e){if(e.id===this.state.sound.id){var t=!this.state.flagged;this.setState({flagging:!1,flagged:t})}}},{key:"playToggle",value:function(){var e=this.playlist.getCurrentSound();e&&e.author===this.state.sound.author&&e.permlink===this.state.sound.permlink?this.state.playing?this.soundengine.pause():this.soundengine.play():(this.playlist.playSound(this.state.sound,this.state.pos),this.soundengine.load(this.playlist.getIpfsUrl(this.state.sound.metadata.audio.files.sound,this.state.sound)))}},{key:"clickWaveform",value:function(e){var t=this.playlist.getCurrentSound();t&&t.author===this.state.sound.author&&t.permlink===this.state.sound.permlink?(this.soundengine.seekTo(e),this.state.playing||this.soundengine.play()):(this.playlist.playSound(this.state.sound,e),this.soundengine.load(this.playlist.getIpfsUrl(this.state.sound.metadata.audio.files.sound,this.state.sound)))}},{key:"clickVote",value:function(){this.state.voting||(this.playlist.voteSound(this.state.sound,!this.state.voted),this.setState({voting:!0}))}},{key:"clickRepost",value:function(){this.state.reposting||this.state.reposted||(this.playlist.repostSound(this.state.sound),this.setState({reposting:!0}))}},{key:"clickEdit",value:function(){this.props.history.push("/@"+this.state.sound.author+"/"+this.state.sound.permlink+"/edit")}},{key:"clickDownload",value:function(){var e=this.state.sound.metadata.audio.dlgate;e&&e.length>0?window.open(e,"_blank"):ge(this.playlist.getIpfsUrl(this.state.sound.metadata.audio.files.sound,this.state.sound),this.state.sound.metadata.audio.title)}},{key:"clickBuy",value:function(){var e=this.state.sound.metadata.audio.buyurl;e&&e.length>0&&window.open(e,"_blank")}},{key:"clickFlag",value:function(){this.state.flagging||(this.playlist.flagSound(this.state.sound,!this.state.flagged),this.setState({flagging:!0}))}},{key:"onProfilePictureError",value:function(e){e.target.src=G.a}},{key:"clickFollow",value:function(){var e=this;this.author&&!this.state.ongoingFollow&&(this.setState({ongoingFollow:!0}),this.steem.followUser(this.author).then(function(t){e.setState({ongoingFollow:!1,following:!0,follows:Object(v.a)({},e.state.follows,{follower_count:e.state.follows.follower_count+1})})}).catch(function(e){console.log("Error following:",e)}))}},{key:"clickUnfollow",value:function(){var e=this;this.author&&!this.state.ongoingFollow&&(this.setState({ongoingFollow:!0}),this.steem.unfollowUser(this.author).then(function(t){e.setState({ongoingFollow:!1,following:!1,follows:Object(v.a)({},e.state.follows,{follower_count:e.state.follows.follower_count-1})})}).catch(function(e){console.log("Error unfollowing:",e)}))}},{key:"componentDidMount",value:function(){var e=this,t=this.auth.getAuthUser(),a=[];a.push(this.steem.getUserMetadata(this.author)),a.push(this.steem.getUserFollowCount(this.author)),a.push(this.steem.getSoundData(this.author,this.permlink)),t&&a.push(this.steem.getUserFollowing(t.name)),Promise.all(a).then(function(a){var n=a[0],s=a[1],i=a[2],o=!1;if(document.title=i.title+" | DSound - Decentralized Sound Platform",t){var r=a[3];r&&(o=void 0!==r.find(function(e){return e.following===n.name}))}var l=e.playlist.checkVoted(i,t),c=i.upvotes,u=e.playlist.checkFlagged(i,t),d=!1,h=0,m=e.playlist.getCurrentSound();m&&m.author===i.author&&m.permlink===i.permlink&&(h=e.soundengine.getCurrentPos(),(d=e.soundengine.isPlaying())&&e.soundengine.on("audioprocess",e.handleSoundEngineProgress)),e.setState({following:o,loading:!1,author:n,follows:s,sound:i,playing:d,pos:h,voted:l,votes:c,flagged:u})}).catch(function(e){console.log("Error getting sound data:",e)}),this.soundengine.on("play",this.handleSoundEnginePlay),this.soundengine.on("pause",this.handleSoundEnginePause),this.soundengine.on("finish",this.handleSoundEngineFinish),this.playlist.on("play-sound",this.handlePlaylistPlaySound),this.playlist.on("voted",this.toggleVote),this.playlist.on("reposted",this.handleRepost),this.playlist.on("flagged",this.toggleFlag)}},{key:"componentWillUnmount",value:function(){this.soundengine.un("play",this.handleSoundEnginePlay),this.soundengine.un("pause",this.handleSoundEnginePause),this.soundengine.un("finish",this.handleSoundEngineFinish),this.soundengine.un("audioprocess",this.handleSoundEngineProgress),this.playlist.un("play-sound",this.handlePlaylistPlaySound),this.playlist.un("voted",this.toggleVote),this.playlist.un("reposted",this.handleRepost),this.playlist.un("flagged",this.toggleFlag)}},{key:"render",value:function(){var e=this,t=W.a.getConfig();if(this.state.loading)return i.a.createElement("div",{className:"loading animated fadeIn fadeOut"},i.a.createElement("img",{className:"orange-load",src:Re.a,alt:""}));var a,n=this.auth.getAuthUser(),s=0,o=[this.state.sound.metadata.audio.type,this.state.sound.metadata.audio.genre].map(function(t){return i.a.createElement(J.a,{key:s++,to:e.playlist.getCategoryLink(t.substring(0,20))},i.a.createElement(A.a,{className:"sound-page-player-tag"},"#",t.substring(0,20)))}),r=this.state.playing?i.a.createElement("i",{className:"fa fa-pause fa-lg",style:{marginLeft:0}}):i.a.createElement("i",{className:"fa fa-play fa-lg"});a=this.state.sound.metadata.audio.files.cover?i.a.createElement("div",{className:"sound-page-cover-image",style:{backgroundImage:"url("+this.playlist.getIpfsUrl(this.state.sound.metadata.audio.files.cover,this.state.sound)+")"}}):i.a.createElement("div",{className:"sound-page-cover-image"});var l,c,u,d,h,m,p,f=this.state.sound?"/@"+this.state.sound.author:"";(this.state.sound.metadata.audio.duration&&(l=i.a.createElement("span",{className:"player-duration"},_.time(this.state.sound.metadata.audio.duration))),n?(c=this.state.voted?i.a.createElement("button",{onClick:this.clickVote,className:"bottom-player-btn active"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)):i.a.createElement("button",{onClick:this.clickVote,className:"bottom-player-btn"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)),n.name===this.state.sound.author&&(d=i.a.createElement("button",{onClick:this.clickEdit,className:"bottom-player-btn"},i.a.createElement("i",{className:"fa fa-pencil"}))),(n.name!==this.state.sound.author||this.state.sound.category.startsWith(t.community.prefix))&&(u=this.state.reposted?i.a.createElement("button",{onClick:this.clickRepost,className:"bottom-player-btn active"},i.a.createElement("i",{className:"fa fa-retweet"})):i.a.createElement("button",{onClick:this.clickRepost,className:"bottom-player-btn"},i.a.createElement("i",{className:"fa fa-retweet"}))),h=this.state.flagged?i.a.createElement("button",{onClick:this.clickFlag,className:"bottom-flag-btn active"},i.a.createElement("i",{className:"fa fa-flag-o"})):i.a.createElement("button",{onClick:this.clickFlag,className:"bottom-flag-btn"},i.a.createElement("i",{className:"fa fa-flag-o"}))):(c=i.a.createElement("button",{className:"bottom-player-btn disabled"},i.a.createElement("i",{className:"fa fa-heart"})," ",_.number(this.state.votes)),0===this.state.sound.author_rewards&&(u=i.a.createElement("button",{className:"bottom-player-btn disabled"},i.a.createElement("i",{className:"fa fa-retweet"}))),h=i.a.createElement("button",{className:"bottom-flag-btn disabled"},i.a.createElement("i",{className:"fa fa-flag-o"}))),this.state.sound.metadata.audio.download?m=i.a.createElement("button",{onClick:this.clickDownload,className:"bottom-player-btn d-md-down-none"},i.a.createElement("i",{className:"fa fa-download"})," Download"):this.state.sound.metadata.audio.buy&&(m=i.a.createElement("button",{onClick:this.clickBuy,className:"bottom-player-btn d-md-down-none"},i.a.createElement("i",{className:"fa fa-shopping-basket"})," Buy")),this.state.sound.metadata.audio.tags&&this.state.sound.metadata.audio.tags.length)&&(s=0,p=this.state.sound.metadata.tags.filter(function(e){return e!==z.MainTag&&!e.startsWith(z.TagPrefix)}).map(function(e){return i.a.createElement(A.a,{key:s++,className:"sound-page-body-tag"},"#",e.substring(0,20))}));var g,v,y,b,k,E,w,N,S=i.a.createElement(bt,{comment:this.state.sound,auth:this.auth,steem:this.steem});return g=this.state.author.profile&&this.state.author.profile.profile_image?this.state.author.profile.profile_image:G.a,v=this.state.author.profile&&this.state.author.profile.name&&this.state.author.profile.name!==this.state.author.name?i.a.createElement("div",{className:"author-name-area"},i.a.createElement(J.a,{to:f},i.a.createElement("div",{className:"author-name"},this.state.author.profile.name),i.a.createElement("div",{className:"author-nickname"},"@",this.state.author.name))):i.a.createElement("div",{className:"author-name-area"},i.a.createElement(J.a,{to:f},i.a.createElement("div",{className:"author-name"},"@",this.state.author.name))),this.state.author.profile&&this.state.author.profile.location&&(y=i.a.createElement("div",{className:"author-location"},i.a.createElement("div",{className:"author-name"},this.state.author.profile.location))),this.state.follows&&(b=i.a.createElement("div",{className:"author-follows"},i.a.createElement("span",{className:"followers"},i.a.createElement("i",{className:"fa fa-users"}),_.number(this.state.follows.follower_count)),i.a.createElement("span",{className:"following"},i.a.createElement("i",{className:"fa fa-user"}),_.number(this.state.follows.following_count)))),n&&this.state.author&&this.state.author.name!==n.name&&(k=this.state.following?i.a.createElement("button",{onClick:this.clickUnfollow,className:"btn-follow-unfollow"},i.a.createElement("i",{className:"fa fa-user-times"})," Unfollow"):i.a.createElement("button",{onClick:this.clickFollow,className:"btn-follow-unfollow"},i.a.createElement("i",{className:"fa fa-user-plus"})," Follow")),this.state.author.profile&&this.state.author.profile.about&&(E=i.a.createElement("div",{className:"author-about"},this.state.author.profile.about)),this.state.author.profile&&this.state.author.profile.website&&(w=i.a.createElement("div",{className:"author-website"},i.a.createElement("a",{href:this.state.author.profile.website,target:"_blank",rel:"noopener noreferrer"},i.a.createElement("i",{className:"fa fa-external-link"})," Website"))),N=0!==parseFloat(this.state.sound.pending_payout_value)?this.state.sound.pending_payout_value:this.state.sound.total_payout_value,i.a.createElement("section",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("article",{className:"sound-page fill"},i.a.createElement("div",{className:"sound-page-top"},i.a.createElement("div",{className:"sound-page-player-area"},i.a.createElement("div",{className:"sound-page-player-top"},i.a.createElement("button",{className:"sound-page-player-play",onClick:this.playToggle},r),i.a.createElement("div",{className:"sound-page-texts"},i.a.createElement("div",{className:"sound-page-player-author"},i.a.createElement(J.a,{to:f},"@"+this.state.sound.author),i.a.createElement("span",{className:"from-now"},_.dateFromNow(this.state.sound.created))),i.a.createElement("div",{className:"sound-page-player-title"},this.state.sound.metadata.audio.title.substring(0,100),l)),i.a.createElement("div",{className:"sound-page-player-tags"},o)),i.a.createElement("div",{className:"sound-page-top-spacer"}),i.a.createElement("div",{className:"track-player-wave"},i.a.createElement(Ae,{peaks:this.playlist.getIpfsUrl(this.state.sound.metadata.audio.files.peaks,this.state.sound),pos:this.state.pos,onPosChange:this.clickWaveform,options:{height:160,barWidth:2,progressColor:"#f49b0b",cursorColor:"rgba(0,0,0,0.0)"}}))),a),i.a.createElement("div",{className:"sound-page-body"},i.a.createElement("div",{className:"left-column"},i.a.createElement("div",{className:"bottom-player-area"},c,d,u,m,i.a.createElement("div",{className:"bottom-player-info"},"$"+_.sbd(N),i.a.createElement("i",{className:"fa fa-comments"})," ",_.number(this.state.sound.children),h)),i.a.createElement("div",{className:"sound-page-post-time"},i.a.createElement(J.a,{to:f},"@",this.state.sound.author),i.a.createElement("span",{className:"post-time"}," published ",_.dateFromNow(this.state.sound.created))),i.a.createElement("div",{className:"sound-page-description"},i.a.createElement(yt,{text:this.state.sound.metadata.audio.desc,jsonMetadata:this.state.sound.metadata,large:!0})),i.a.createElement("div",{className:"sound-page-body-tags"},p),S,i.a.createElement("div",{className:"filler"})),i.a.createElement("div",{className:"right-column d-md-down-none"},i.a.createElement("div",{className:"author-details"},i.a.createElement("div",{className:"author-picture-area"},i.a.createElement(J.a,{to:f},i.a.createElement("img",{src:g,className:"author-picture",alt:"",onError:this.onProfilePictureError}))),v,y,b,k,E,w),i.a.createElement("div",{className:"filler"})))),i.a.createElement("div",{className:"sound-page-bottom"},i.a.createElement("i",{className:"fa fa-ellipsis-h fa-lg"}),i.a.createElement("p",null,i.a.createElement("span",{className:"footer-quote"},"Music is what feelings sound like!"),i.a.createElement("br",null),"DSound ",i.a.createElement("i",{className:"heart fa fa-heart-o"})," music"))))}}]),t}(s.Component),Et=a(476),wt=function(e){function t(e){var a;Object(d.a)(this,t),a=Object(m.a)(this,Object(p.a)(t).call(this,e));var n=W.a.getConfig();return a.auth=a.props.auth,a.steem=a.props.steem,a.ipfs=a.props.ipfs,a.soundengine=a.props.soundengine,a.state={upload:{title:"",desc:"",type:"",genre:"",tags:"",download:!0,dlgate:"",buy:!1,buyurl:"",where:n.community.hive},validation:{title:!1,type:!1,genre:!1,where:!0},ipfs:{node:!1,sound:"",cover:"",peaks:""},stateSound:"init",stateCover:"init",isDoneSound:!1,isDoneCover:!1,isPublished:!1},a.onDragOverSound=a.onDragOverSound.bind(Object(y.a)(Object(y.a)(a))),a.onDragOverCover=a.onDragOverCover.bind(Object(y.a)(Object(y.a)(a))),a.onDragLeaveSound=a.onDragLeaveSound.bind(Object(y.a)(Object(y.a)(a))),a.onDragLeaveCover=a.onDragLeaveCover.bind(Object(y.a)(Object(y.a)(a))),a.onSelectSoundFile=a.onSelectSoundFile.bind(Object(y.a)(Object(y.a)(a))),a.onSelectCoverFile=a.onSelectCoverFile.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundFiles=a.handleSoundFiles.bind(Object(y.a)(Object(y.a)(a))),a.handleCoverFiles=a.handleCoverFiles.bind(Object(y.a)(Object(y.a)(a))),a.onChangeTitle=a.onChangeTitle.bind(Object(y.a)(Object(y.a)(a))),a.onFormatTitle=a.onFormatTitle.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDesc=a.onChangeDesc.bind(Object(y.a)(Object(y.a)(a))),a.onFormatDesc=a.onFormatDesc.bind(Object(y.a)(Object(y.a)(a))),a.onChangeType=a.onChangeType.bind(Object(y.a)(Object(y.a)(a))),a.onChangeGenre=a.onChangeGenre.bind(Object(y.a)(Object(y.a)(a))),a.onFormatGenre=a.onFormatGenre.bind(Object(y.a)(Object(y.a)(a))),a.onChangeTags=a.onChangeTags.bind(Object(y.a)(Object(y.a)(a))),a.onFormatTags=a.onFormatTags.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDl=a.onChangeDl.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDlGate=a.onChangeDlGate.bind(Object(y.a)(Object(y.a)(a))),a.onFormatDlGate=a.onFormatDlGate.bind(Object(y.a)(Object(y.a)(a))),a.onChangeBuy=a.onChangeBuy.bind(Object(y.a)(Object(y.a)(a))),a.onChangeBuyUrl=a.onChangeBuyUrl.bind(Object(y.a)(Object(y.a)(a))),a.onFormatBuyUrl=a.onFormatBuyUrl.bind(Object(y.a)(Object(y.a)(a))),a.onChangeWhere=a.onChangeWhere.bind(Object(y.a)(Object(y.a)(a))),a.doPublish=a.doPublish.bind(Object(y.a)(Object(y.a)(a))),a.doCancel=a.doCancel.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"onDragOverSound",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({stateSound:"over"})}},{key:"onDragLeaveSound",value:function(e){this.setState({stateSound:this.state.isDoneSound?"done":"init"})}},{key:"onSelectSoundFile",value:function(){r.a.findDOMNode(this.refs.uploadSoundFile).click()}},{key:"handleSoundFiles",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=e.target.files||e.dataTransfer.files;if(a&&0!==a.length){for(var n=null,s=0;s<a.length;s++)if(a[s].type.startsWith("audio/")){n=a[s];break}if(n){var i=this.state.upload.title,o=this.state.validation.title;""===i&&n.name&&(o=(i=n.name.split(".")[0]).length>6);var r,l=this.state.ipfs.node;l||(l=this.ipfs.getPublicNode()),this.setState({ipfs:Object(v.a)({},this.state.ipfs,{node:l}),upload:Object(v.a)({},this.state.upload,{title:i}),validation:Object(v.a)({},this.state.validation,{title:o}),stateSound:"processing"}),this.readFileData(n).then(function(e){return r=e,t.getSoundPeaks(e)}).then(function(e){var a=e.peaks,n=e.duration;t.setState({upload:Object(v.a)({},t.state.upload,{duration:n}),stateSound:"uploading"});var s=[].map.call(a,function(e){return Math.round(1e4*e)/1e4});return t.ipfs.fileAdd(JSON.stringify(s))}).then(function(e){return t.setState({ipfs:Object(v.a)({},t.state.ipfs,{peaks:e[0].hash})}),t.ipfs.fileAdd(r)}).then(function(e){t.setState({ipfs:Object(v.a)({},t.state.ipfs,{sound:e[0].hash}),stateSound:"done",isDoneSound:!0})}).catch(function(e){"processing"===t.state.stateSound?L.toast.error("Couln't process the file. Try with another format please..."):L.toast.error("Couldn't upload the file. Please check your IPFS settings..."),console.log(e),t.setState({stateSound:"init"})})}else L.toast.error("Unsuported sound file. Please use .wav, .mp3, or other standard format...")}}},{key:"onDragOverCover",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({stateCover:"over"})}},{key:"onDragLeaveCover",value:function(e){this.setState({stateCover:this.state.isDoneCover?"done":"init"})}},{key:"onSelectCoverFile",value:function(){r.a.findDOMNode(this.refs.uploadCoverFile).click()}},{key:"handleCoverFiles",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=e.target.files||e.dataTransfer.files;if(a&&0!==a.length){for(var n=null,s=0;s<a.length;s++)if(a[s].type.startsWith("image/")){n=a[s];break}if(n){var i,o=this.state.ipfs.node;o||(o=this.ipfs.getPublicNode()),this.setState({ipfs:Object(v.a)({},this.state.ipfs,{node:o}),stateCover:"uploading"}),this.readFileData(n).then(function(e){return i=e,t.ipfs.fileAdd(e)}).then(function(e){t.setState({ipfs:Object(v.a)({},t.state.ipfs,{cover:e[0].hash}),stateCover:"done",isDoneCover:!0}),t.setBackgroudImageData("imageCover",i)}).catch(function(e){L.toast.error("Couldn't upload the file. Please check your IPFS settings..."),t.setState({stateCover:"init"})})}else L.toast.error("Unsuported cover file. Please use .jpg, .png, or other standard format...")}}},{key:"onChangeTitle",value:function(e){var t=e.target.value,a=!1;t&&t.length>=6&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{title:t}),validation:Object(v.a)({},this.state.validation,{title:a})})}},{key:"onFormatTitle",value:function(e){var t=e.target.value,a=Ge(ze()(t,{allowedTags:[]}));a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{title:a})})}},{key:"onChangeDesc",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{desc:t})})}},{key:"onFormatDesc",value:function(e){var t=e.target.value,a=ze()(t,ft({large:!0}));a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{desc:a})})}},{key:"onChangeType",value:function(e){var t=e.target.value,a=!1;t&&t.length>0&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{type:t}),validation:Object(v.a)({},this.state.validation,{type:a})})}},{key:"onChangeGenre",value:function(e){var t=e.target.value,a=!1;t&&t.length>=3&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{genre:t}),validation:Object(v.a)({},this.state.validation,{genre:a})})}},{key:"onFormatGenre",value:function(e){var t=e.target.value,a=this.state.validation.genre,n=t.split(",")[0];(n=this.formatGenre(n))!==t&&(n&&n.length>=3&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{genre:n}),validation:Object(v.a)({},this.state.validation,{genre:a})}))}},{key:"onChangeTags",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{tags:t})})}},{key:"onFormatTags",value:function(e){var t=this,a=e.target.value,n=this.state.validation.tags,s=a.split(",").map(function(e){return t.formatTag(e)}).filter(function(e){return e.length>0}).slice(0,4).join(", ");s!==a&&(s&&s.length>=3&&(n=!0),this.setState({upload:Object(v.a)({},this.state.upload,{tags:s}),validation:Object(v.a)({},this.state.validation,{tags:n})}))}},{key:"onChangeDl",value:function(e){var t=e.target.checked,a=this.state.upload.buy;t&&a&&(a=!1),this.setState({upload:Object(v.a)({},this.state.upload,{download:t,buy:a})})}},{key:"onChangeDlGate",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{dlgate:t})})}},{key:"onFormatDlGate",value:function(e){var t=e.target.value,a=fe.filterUrl(t);a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{dlgate:a})})}},{key:"onChangeBuy",value:function(e){var t=e.target.checked,a=this.state.upload.download;t&&a&&(a=!1),this.setState({upload:Object(v.a)({},this.state.upload,{buy:t,download:a})})}},{key:"onChangeBuyUrl",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{buyurl:t})})}},{key:"onFormatBuyUrl",value:function(e){var t=e.target.value,a=fe.filterUrl(t);a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{buyurl:a})})}},{key:"onChangeWhere",value:function(e){var t=e.target.value,a=!1;t&&t.length>0&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{where:t}),validation:Object(v.a)({},this.state.validation,{where:a})})}},{key:"doPublish",value:function(e){var t=this;this.setState({isPublished:!0}),this.steem.publishSound(this.state.upload,this.state.ipfs).then(function(){L.toast.info("Your sound was published!"),t.props.history.push("/new")}).catch(function(e){L.toast.error("Error publishing the sound. Please check network connection...")})}},{key:"doCancel",value:function(e){this.props.history.push("/")}},{key:"formatGenre",value:function(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"").substring(0,20)}},{key:"formatTag",value:function(e){return e.toLowerCase().replace(/[^a-z0-9-]/g,"").substring(0,20)}},{key:"readFileData",value:function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(e){return t(n.result)},n.onerror=function(e){return a(n.error)},n.readAsArrayBuffer(e)})}},{key:"getSoundPeaks",value:function(e){var t=this;return this.soundengine.initIfNeeded(),new Promise(function(a,n){var s=new ArrayBuffer(e.byteLength);new Uint8Array(s).set(new Uint8Array(e)),t.soundengine.decodeArrayBuffer(s,function(e){var s=e.duration,i=t.soundengine.getPeaksFromBuffer(e,1024);i&&i.length>0?a({peaks:i,duration:s}):n(new Error("Couldn't get the peaks from audio data"))})})}},{key:"setBackgroudImageData",value:function(e,t){var a=r.a.findDOMNode(this.refs[e]),n=URL.createObjectURL(new Blob([new Uint8Array(t)]));a.style.backgroundImage="url("+n+")"}},{key:"componentDidMount",value:function(){document.title=" Upload Sound | DSound - Decentralized Sound Platform"}},{key:"getSoundUploader",value:function(){switch(this.state.stateSound){default:case"init":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title d-md-up-none"},"Drag & drop"),i.a.createElement("p",{className:"sound-uploader-title d-sm-down-none"},"Drag & drop here"),i.a.createElement("p",{className:"sound-uploader-text"},"or"),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Select sound file"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})),i.a.createElement("p",{className:"sound-uploader-text d-md-up-none"},"We recommend MP3 128Kbps files..."),i.a.createElement("p",{className:"sound-uploader-text d-sm-down-none"},"We recommend MP3 128Kbps files, but FLAC, OGG, MP4, AAC, WAV and others might also be ok..."));case"over":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Drop here!!!"),i.a.createElement("p",{className:"sound-uploader-text"},"or"),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Select sound file"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})),i.a.createElement("p",{className:"sound-uploader-text d-md-up-none"},"We recommend MP3 128Kbps files..."),i.a.createElement("p",{className:"sound-uploader-text d-sm-down-none"},"We recommend MP3 128Kbps files, but FLAC, OGG, MP4, AAC, WAV and others might also be ok..."));case"processing":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Processing your sound..."),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100",animated:!0}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100",animated:!0})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile,disabled:!0},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})));case"uploading":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Uploading to IPFS..."),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100"}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100",animated:!0})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile,disabled:!0},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})));case"done":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Sound uploaded!"),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100"}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100"})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})))}}},{key:"getCoverUploader",value:function(){switch(this.state.stateCover){default:case"init":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"Drag & drop cover"),i.a.createElement("p",{className:"cover-uploader-text"},"or"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Select cover image"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})));case"over":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"Drop cover here!!!"),i.a.createElement("p",{className:"cover-uploader-text"},"or"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Select cover image"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})));case"uploading":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("img",{className:"cover-uploader-loading",src:Re.a,alt:"uploading"}));case"done":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"\xa0",i.a.createElement("br",null),"\xa0"),i.a.createElement("p",{className:"cover-uploader-text"},"\xa0"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Change cover"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})))}}},{key:"render",value:function(){var e=W.a.getConfig();return i.a.createElement("section",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"main-page col-sm-12 fill"},i.a.createElement("div",{className:"row-fluid"},i.a.createElement("h1",{className:"page-title"},"Upload your sound")),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("div",{className:"sound-uploader-panel",onDragOver:this.onDragOverSound,onDragLeave:this.onDragLeaveSound,onDrop:this.handleSoundFiles},this.getSoundUploader()))),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement(D.a,{color:"warning d-md-up-none",className:"upload-alert form-alert justify"},i.a.createElement("strong",null,"Important"),": DSound platform is made by musicians for musicians and music fans and it will always stay like that! Share your sounds here and please respect the artists and community. Take the best out of DSound by spreading ",i.a.createElement("i",{className:"fa fa-heart",alt:"love"})," through your sounds, and enjoy! :)"),i.a.createElement(D.a,{color:"warning d-sm-down-none",className:"upload-alert form-alert justify"},i.a.createElement("strong",null,"Important"),": DSound platform is made by musicians for musicians and music fans and it will always stay like that! Share your sounds here and please respect the artists and community. All content is responsibility of the person that shared it and it will be distributed all over the Internet and only linked to in the ",e.chain.name.toUpperCase()," blockchain, thus getting a life of it","'","s own. DSound platform cannot control the content shared as it is stored decentralised on IPFS network, without any central servers, and ",e.chain.name.toUpperCase()," blockchain is a decentralised and permanent database impossible to block or censor. If your sound does not respect the artists and community, if it is shared in the wrong category, if it is not labeled right or if you share offensive content is entirely up to you, but be ready to have the response of the community by flagging your post and lowering your reputation... Take the best out of DSound by spreading ",i.a.createElement("i",{className:"fa fa-heart",alt:"love"})," through your sounds, and enjoy! :)"))),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("h2",{className:"section-title"},"Sound Info"))),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement(P.a,null,i.a.createElement("div",{className:"upload-info-area"},i.a.createElement("div",{className:"upload-cover",ref:"imageCover",onDragOver:this.onDragOverCover,onDragLeave:this.onDragLeaveCover,onDrop:this.handleCoverFiles},this.getCoverUploader()),i.a.createElement("div",{className:"upload-sound-form"},i.a.createElement(x.a,{color:this.state.validation.title?"":"warning"},i.a.createElement(F.a,{type:"text",name:"title",value:this.state.upload.title,onChange:this.onChangeTitle,state:this.state.validation.title?"":"warning",className:"form-field",placeholder:"Sound title",onBlur:this.onFormatTitle,maxLength:"100"})),i.a.createElement(x.a,null,i.a.createElement(F.a,{type:"textarea",name:"desc",onChange:this.onChangeDesc,value:this.state.upload.desc,className:"form-textarea",placeholder:"Sound description",onBlur:this.onFormatDesc})),i.a.createElement(x.a,{className:"form-inline"},i.a.createElement(x.a,{color:this.state.validation.type?"":"warning"},i.a.createElement(F.a,{type:"select",name:"type",value:this.state.upload.type,onChange:this.onChangeType,state:this.state.validation.type?"":"warning",className:"form-field right-space",placeholder:"Sound type..."},i.a.createElement("option",{value:""},"Choose sound type...\xa0\xa0\xa0\xa0"),i.a.createElement("optgroup",{label:"Music"},i.a.createElement("option",{value:"original"},"Original track"),i.a.createElement("option",{value:"cover"},"Cover"),i.a.createElement("option",{value:"remix"},"Remix"),i.a.createElement("option",{value:"mashup"},"Mashup"),i.a.createElement("option",{value:"live"},"Live performance"),i.a.createElement("option",{value:"demo"},"Demo/promo track"),i.a.createElement("option",{value:"djset"},"DJ set")),i.a.createElement("optgroup",{label:"Podcasts & recordings"},i.a.createElement("option",{value:"podcast"},"Podcast show"),i.a.createElement("option",{value:"recording"},"Recording"),i.a.createElement("option",{value:"field"},"Field recording"),i.a.createElement("option",{value:"spoken"},"Spoken track")),i.a.createElement("optgroup",{label:"Samples & others"},i.a.createElement("option",{value:"effect"},"Sound effect"),i.a.createElement("option",{value:"sample"},"One shot sample"),i.a.createElement("option",{value:"loop"},"Loop sample"),i.a.createElement("option",{value:"stem"},"Stem"),i.a.createElement("option",{value:"inprogress"},"Work in progress"),i.a.createElement("option",{value:"other"},"Other")))),i.a.createElement(x.a,{color:this.state.validation.genre?"":"warning"},i.a.createElement(F.a,{type:"text",name:"genre",value:this.state.upload.genre,onChange:this.onChangeGenre,state:this.state.validation.genre?"":"warning",onBlur:this.onFormatGenre,maxLength:"15",className:"form-field right-space",placeholder:"Genre or main tag"})),i.a.createElement(x.a,{className:"wide"},i.a.createElement(F.a,{type:"text",name:"tags",value:this.state.upload.tags,onChange:this.onChangeTags,onBlur:this.onFormatTags,className:"form-field wide",placeholder:"Tags (coma separated)"}))))),i.a.createElement("div",{className:"upload-settings-area"},i.a.createElement(x.a,{className:"wide"},i.a.createElement("label",{className:"switch switch-text switch-pill switch-success"},i.a.createElement("input",{type:"checkbox",id:"sw-dl",checked:this.state.upload.download,onChange:this.onChangeDl,className:"switch-input"}),i.a.createElement("span",{className:"switch-label","data-on":"On","data-off":"Off"}),i.a.createElement("span",{className:"switch-handle"})),i.a.createElement(Et.a,{className:"form-switch-label",htmlFor:"sw-dl"},"Download button"),i.a.createElement("span",{className:"form-note d-md-down-none"},"(Note: all content shared in IPFS is downloadable. This disables the button only.)"),i.a.createElement(F.a,{type:"text",name:"dlgate",value:this.state.upload.dlgate,disabled:!this.state.upload.download,onChange:this.onChangeDlGate,className:"form-field wide",placeholder:"Download gate url (leave empty for direct download from DSound)",onBlur:this.onFormatDlGate})),i.a.createElement(x.a,{className:"wide"},i.a.createElement("label",{className:"switch switch-text switch-pill switch-success"},i.a.createElement("input",{type:"checkbox",id:"sw-buy",checked:this.state.upload.buy,onChange:this.onChangeBuy,className:"switch-input"}),i.a.createElement("span",{className:"switch-label","data-on":"On","data-off":"Off"}),i.a.createElement("span",{className:"switch-handle"})),i.a.createElement(Et.a,{className:"form-switch-label",htmlFor:"sw-buy"},"Buy button"),i.a.createElement("span",{className:"form-note d-md-down-none"},"(Show a 'Buy' button instead.)"),i.a.createElement(F.a,{type:"text",name:"buyurl",value:this.state.upload.buyurl,disabled:!this.state.upload.buy,onChange:this.onChangeBuyUrl,className:"form-field wide",placeholder:"Buy url of your sound on your preferred music store",onBlur:this.onFormatBuyUrl}))),i.a.createElement("div",{className:"upload-submit-area"},i.a.createElement("div",{style:{flex:1}}),i.a.createElement(x.a,{className:"form-inline"},i.a.createElement(x.a,{color:this.state.validation.type?"":"warning"},i.a.createElement(F.a,{type:"select",name:"where",value:this.state.upload.where,onChange:this.onChangeWhere,state:this.state.validation.where?"":"warning",className:"form-field right-space",placeholder:"Publish destination..."},i.a.createElement("optgroup",{label:"DSound"},i.a.createElement("option",{value:e.community.hive},"DSound Community"),i.a.createElement("option",{value:e.tags.main},"User Profile")),i.a.createElement("optgroup",{label:"Other Communities"},i.a.createElement("option",{value:"none",disabled:!0},"Here soon...")))),i.a.createElement(x.a,null,i.a.createElement(S.a,{color:"primary",onClick:this.doPublish,className:"form-submit",disabled:!this.state.isDoneSound||!this.state.validation.title||!this.state.validation.type||!this.state.validation.genre||this.state.isPublished},i.a.createElement("i",{className:"fa fa-check-square-o fa-lg"})," Publish"),"\xa0",i.a.createElement(S.a,{color:"secondary",onClick:this.doCancel,className:"form-cancel"},i.a.createElement("i",{className:"fa fa-close fa-lg"})," Cancel"))))))))))}}]),t}(s.Component),Nt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=a.props.auth,a.steem=a.props.steem,a.ipfs=a.props.ipfs,a.soundengine=a.props.soundengine,a.author=a.props.match.params.user,a.permlink=a.props.match.params.permlink,a.state={upload:{title:"",desc:"",type:"",genre:"",tags:"",download:!0,dlgate:"",buy:!1,buyurl:"",duration:0},validation:{title:!1,type:!1,genre:!1},ipfs:{node:!1,sound:"",cover:"",peaks:""},stateSound:"init",stateCover:"init",isDoneSound:!1,isDoneCover:!1,isPublished:!1},a.onDragOverSound=a.onDragOverSound.bind(Object(y.a)(Object(y.a)(a))),a.onDragOverCover=a.onDragOverCover.bind(Object(y.a)(Object(y.a)(a))),a.onDragLeaveSound=a.onDragLeaveSound.bind(Object(y.a)(Object(y.a)(a))),a.onDragLeaveCover=a.onDragLeaveCover.bind(Object(y.a)(Object(y.a)(a))),a.onSelectSoundFile=a.onSelectSoundFile.bind(Object(y.a)(Object(y.a)(a))),a.onSelectCoverFile=a.onSelectCoverFile.bind(Object(y.a)(Object(y.a)(a))),a.handleSoundFiles=a.handleSoundFiles.bind(Object(y.a)(Object(y.a)(a))),a.handleCoverFiles=a.handleCoverFiles.bind(Object(y.a)(Object(y.a)(a))),a.onChangeTitle=a.onChangeTitle.bind(Object(y.a)(Object(y.a)(a))),a.onFormatTitle=a.onFormatTitle.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDesc=a.onChangeDesc.bind(Object(y.a)(Object(y.a)(a))),a.onFormatDesc=a.onFormatDesc.bind(Object(y.a)(Object(y.a)(a))),a.onChangeType=a.onChangeType.bind(Object(y.a)(Object(y.a)(a))),a.onChangeGenre=a.onChangeGenre.bind(Object(y.a)(Object(y.a)(a))),a.onFormatGenre=a.onFormatGenre.bind(Object(y.a)(Object(y.a)(a))),a.onChangeTags=a.onChangeTags.bind(Object(y.a)(Object(y.a)(a))),a.onFormatTags=a.onFormatTags.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDl=a.onChangeDl.bind(Object(y.a)(Object(y.a)(a))),a.onChangeDlGate=a.onChangeDlGate.bind(Object(y.a)(Object(y.a)(a))),a.onFormatDlGate=a.onFormatDlGate.bind(Object(y.a)(Object(y.a)(a))),a.onChangeBuy=a.onChangeBuy.bind(Object(y.a)(Object(y.a)(a))),a.onChangeBuyUrl=a.onChangeBuyUrl.bind(Object(y.a)(Object(y.a)(a))),a.onFormatBuyUrl=a.onFormatBuyUrl.bind(Object(y.a)(Object(y.a)(a))),a.doSave=a.doSave.bind(Object(y.a)(Object(y.a)(a))),a.doCancel=a.doCancel.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"onDragOverSound",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({stateSound:"over"})}},{key:"onDragLeaveSound",value:function(e){this.setState({stateSound:this.state.isDoneSound?"done":"init"})}},{key:"onSelectSoundFile",value:function(){r.a.findDOMNode(this.refs.uploadSoundFile).click()}},{key:"handleSoundFiles",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=e.target.files||e.dataTransfer.files;if(a&&0!==a.length){for(var n=null,s=0;s<a.length;s++)if(a[s].type.startsWith("audio/")){n=a[s];break}if(n){var i=this.state.upload.title,o=this.state.validation.title;""===i&&n.name&&(o=(i=n.name.split(".")[0]).length>6);var r,l=this.state.ipfs.node;l||(l=this.ipfs.getPublicNode()),this.setState({ipfs:Object(v.a)({},this.state.ipfs,{node:l}),upload:Object(v.a)({},this.state.upload,{title:i}),validation:Object(v.a)({},this.state.validation,{title:o}),stateSound:"processing"}),this.readFileData(n).then(function(e){return r=e,t.getSoundPeaks(e)}).then(function(e){var a=e.peaks,n=e.duration;t.setState({upload:Object(v.a)({},t.state.upload,{duration:n}),stateSound:"uploading"});var s=[].map.call(a,function(e){return Math.round(1e4*e)/1e4});return t.ipfs.fileAdd(JSON.stringify(s))}).then(function(e){return t.setState({ipfs:Object(v.a)({},t.state.ipfs,{peaks:e[0].hash})}),t.ipfs.fileAdd(r)}).then(function(e){t.setState({ipfs:Object(v.a)({},t.state.ipfs,{sound:e[0].hash}),stateSound:"done",isDoneSound:!0})}).catch(function(e){"processing"===t.state.stateSound?L.toast.error("Couln't process the file. Try with another format please..."):L.toast.error("Couldn't upload the file. Please check your IPFS settings..."),t.setState({stateSound:"init"})})}else L.toast.error("Unsuported sound file. Please use .wav, .mp3, or other standard format...")}}},{key:"onDragOverCover",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({stateCover:"over"})}},{key:"onDragLeaveCover",value:function(e){this.setState({stateCover:this.state.isDoneCover?"done":"init"})}},{key:"onSelectCoverFile",value:function(){r.a.findDOMNode(this.refs.uploadCoverFile).click()}},{key:"handleCoverFiles",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=e.target.files||e.dataTransfer.files;if(a&&0!==a.length){for(var n=null,s=0;s<a.length;s++)if(a[s].type.startsWith("image/")){n=a[s];break}if(n){var i,o=this.state.ipfs.node;o||(o=this.ipfs.getPublicNode()),this.setState({ipfs:Object(v.a)({},this.state.ipfs,{node:o}),stateCover:"uploading"}),this.readFileData(n).then(function(e){return i=e,t.ipfs.fileAdd(e)}).then(function(e){t.setState({ipfs:Object(v.a)({},t.state.ipfs,{cover:e[0].hash}),stateCover:"done",isDoneCover:!0}),t.setBackgroudImageData("imageCover",i)}).catch(function(e){L.toast.error("Couldn't upload the file. Please check your IPFS settings..."),t.setState({stateCover:"init"})})}else L.toast.error("Unsuported cover file. Please use .jpg, .png, or other standard format...")}}},{key:"onChangeTitle",value:function(e){var t=e.target.value,a=!1;t&&t.length>=6&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{title:t}),validation:Object(v.a)({},this.state.validation,{title:a})})}},{key:"onFormatTitle",value:function(e){var t=e.target.value,a=Ge(ze()(t,{allowedTags:[]}));a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{title:a})})}},{key:"onChangeDesc",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{desc:t})})}},{key:"onFormatDesc",value:function(e){var t=e.target.value,a=ze()(t,ft({large:!0}));a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{desc:a})})}},{key:"onChangeType",value:function(e){var t=e.target.value,a=!1;t&&t.length>0&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{type:t}),validation:Object(v.a)({},this.state.validation,{type:a})})}},{key:"onChangeGenre",value:function(e){var t=e.target.value,a=!1;t&&t.length>=3&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{genre:t}),validation:Object(v.a)({},this.state.validation,{genre:a})})}},{key:"onFormatGenre",value:function(e){var t=e.target.value,a=this.state.validation.genre,n=t.split(",")[0];(n=this.formatGenre(n))!==t&&(n&&n.length>=3&&(a=!0),this.setState({upload:Object(v.a)({},this.state.upload,{genre:n}),validation:Object(v.a)({},this.state.validation,{genre:a})}))}},{key:"onChangeTags",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{tags:t})})}},{key:"onFormatTags",value:function(e){var t=this,a=e.target.value,n=this.state.validation.tags,s=a.split(",").map(function(e){return t.formatTag(e)}).filter(function(e){return e.length>0}).slice(0,4).join(", ");s!==a&&(s&&s.length>=3&&(n=!0),this.setState({upload:Object(v.a)({},this.state.upload,{tags:s}),validation:Object(v.a)({},this.state.validation,{tags:n})}))}},{key:"onChangeDl",value:function(e){var t=e.target.checked,a=this.state.upload.buy;t&&a&&(a=!1),this.setState({upload:Object(v.a)({},this.state.upload,{download:t,buy:a})})}},{key:"onChangeDlGate",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{dlgate:t})})}},{key:"onFormatDlGate",value:function(e){var t=e.target.value,a=fe.filterUrl(t);a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{dlgate:a})})}},{key:"onChangeBuy",value:function(e){var t=e.target.checked,a=this.state.upload.download;t&&a&&(a=!1),this.setState({upload:Object(v.a)({},this.state.upload,{buy:t,download:a})})}},{key:"onChangeBuyUrl",value:function(e){var t=e.target.value;this.setState({upload:Object(v.a)({},this.state.upload,{buyurl:t})})}},{key:"onFormatBuyUrl",value:function(e){var t=e.target.value,a=fe.filterUrl(t);a!==t&&this.setState({upload:Object(v.a)({},this.state.upload,{buyurl:a})})}},{key:"doSave",value:function(e){var t=this;this.setState({isPublished:!0}),this.steem.updateSound(this.state.original,this.state.upload,this.state.ipfs).then(function(){L.toast.info("Your sound was saved!"),t.props.history.push("/@"+t.state.original.author+"/"+t.state.original.permlink)}).catch(function(e){L.toast.error("Error publishing the sound. Please check network connection..."),t.props.history.push("/@"+t.state.original.author+"/"+t.state.original.permlink)})}},{key:"doCancel",value:function(e){this.props.history.push("/@"+this.state.original.author+"/"+this.state.original.permlink)}},{key:"formatGenre",value:function(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"").substring(0,20)}},{key:"formatTag",value:function(e){return e.toLowerCase().replace(/[^a-z0-9-]/g,"").substring(0,20)}},{key:"readFileData",value:function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(e){return t(n.result)},n.onerror=function(e){return a(n.error)},n.readAsArrayBuffer(e)})}},{key:"getSoundPeaks",value:function(e){var t=this;return new Promise(function(a,n){var s=new ArrayBuffer(e.byteLength);new Uint8Array(s).set(new Uint8Array(e)),t.soundengine.decodeArrayBuffer(s,function(e){var s=e.duration,i=t.soundengine.getPeaksFromBuffer(e,1024);i&&i.length>0?a({peaks:i,duration:s}):n(new Error("Couldn't get the peaks from audio data"))})})}},{key:"setBackgroudImageData",value:function(e,t){var a=r.a.findDOMNode(this.refs[e]),n=URL.createObjectURL(new Blob([new Uint8Array(t)]));a.style.backgroundImage="url("+n+")"}},{key:"setBackgroudImageUrl",value:function(e,t){r.a.findDOMNode(this.refs[e]).style.backgroundImage="url("+t+")"}},{key:"componentDidMount",value:function(){var e=this,t=this.auth.getAuthUser();document.title=" Edit Sound | DSound - Decentralized Sound Platform",t.name===this.author?this.steem.getSoundData(this.author,this.permlink).then(function(t){t.metadata.audio.files.cover&&e.setBackgroudImageUrl("imageCover",e.ipfs.getUrl(t.metadata.audio.files.cover)),e.setState({original:t,upload:{title:t.metadata.audio.title,desc:t.metadata.audio.desc,type:t.metadata.audio.type,genre:t.metadata.audio.genre,tags:t.metadata.audio.tags,download:t.metadata.audio.download,dlgate:t.metadata.audio.dlgate,buy:t.metadata.audio.buy,buyurl:t.metadata.audio.buyurl,duration:t.metadata.audio.duration},validation:{title:!0,type:!0,genre:!0},ipfs:{sound:t.metadata.audio.files.sound,cover:t.metadata.audio.files.cover,peaks:t.metadata.audio.files.peaks},stateSound:""!==t.metadata.audio.files.sound?"done":"init",stateCover:""!==t.metadata.audio.files.cover?"done":"init",isDoneSound:""!==t.metadata.audio.files.sound,isDoneCover:""!==t.metadata.audio.files.cover,isPublished:!1})}).catch(function(e){L.toast.error("Error loading sound data...")}):L.toast.error("Not allowed to edit this sound!")}},{key:"getSoundUploader",value:function(){switch(this.state.stateSound){default:case"init":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title d-md-up-none"},"Drag & drop"),i.a.createElement("p",{className:"sound-uploader-title d-sm-down-none"},"Drag & drop here"),i.a.createElement("p",{className:"sound-uploader-text"},"or"),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Select sound file"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})),i.a.createElement("p",{className:"sound-uploader-text d-md-up-none"},"We recommend MP3 128Kbps files..."),i.a.createElement("p",{className:"sound-uploader-text d-sm-down-none"},"We recommend MP3 128Kbps files, but FLAC, OGG, MP4, AAC, WAV and others might also be ok..."));case"over":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Drop here!!!"),i.a.createElement("p",{className:"sound-uploader-text"},"or"),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Select sound file"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})),i.a.createElement("p",{className:"sound-uploader-text d-md-up-none"},"We recommend MP3 128Kbps files..."),i.a.createElement("p",{className:"sound-uploader-text d-sm-down-none"},"We recommend MP3 128Kbps files, but FLAC, OGG, MP4, AAC, WAV and others might also be ok..."));case"processing":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Processing your sound..."),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100",animated:!0}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100",animated:!0})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile,disabled:!0},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})));case"uploading":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Uploading to IPFS..."),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100"}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100",animated:!0})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile,disabled:!0},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})));case"done":return i.a.createElement("div",{className:"sound-uploader"},i.a.createElement("p",{className:"sound-uploader-title"},"Sound uploaded!"),i.a.createElement("div",{className:"sound-uploader-progress"},i.a.createElement(Z.a,{className:"sound-uploader-prog-proc",color:"info",value:"100",min:"0",max:"100"}),i.a.createElement(Z.a,{className:"sound-uploader-prog-upld",color:"warning",value:"100",min:"0",max:"100"})),i.a.createElement("p",{className:"sound-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectSoundFile},"Change sound"),i.a.createElement("input",{type:"file",ref:"uploadSoundFile",hidden:!0,accept:"audio/*",onChange:this.handleSoundFiles})))}}},{key:"getCoverUploader",value:function(){switch(this.state.stateCover){default:case"init":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"Drag & drop cover"),i.a.createElement("p",{className:"cover-uploader-text"},"or"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Select cover image"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})));case"over":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"Drop cover here!!!"),i.a.createElement("p",{className:"cover-uploader-text"},"or"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Select cover image"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})));case"uploading":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("img",{className:"cover-uploader-loading",src:Re.a,alt:"uploading"}));case"done":return i.a.createElement("div",{className:"cover-uploader"},i.a.createElement("p",{className:"cover-uploader-title"},"\xa0",i.a.createElement("br",null),"\xa0"),i.a.createElement("p",{className:"cover-uploader-text"},"\xa0"),i.a.createElement("p",{className:"cover-uploader-file"},i.a.createElement(S.a,{color:"primary",className:"form-submit",onClick:this.onSelectCoverFile},"Change cover"),i.a.createElement("input",{type:"file",ref:"uploadCoverFile",hidden:!0,accept:"image/*",onChange:this.handleCoverFiles})))}}},{key:"render",value:function(){return i.a.createElement("section",{className:"animated fadeIn"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"main-page col-sm-12 fill"},i.a.createElement("div",{className:"row-fluid"},i.a.createElement("h1",{className:"page-title"},"Edit your sound")),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("h2",{className:"section-title"},"Sound Info"))),i.a.createElement("div",{className:"row-fluid"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement(P.a,null,i.a.createElement("div",{className:"upload-info-area"},i.a.createElement("div",{className:"upload-cover",ref:"imageCover",onDragOver:this.onDragOverCover,onDragLeave:this.onDragLeaveCover,onDrop:this.handleCoverFiles},this.getCoverUploader()),i.a.createElement("div",{className:"upload-sound-form"},i.a.createElement(x.a,{color:this.state.validation.title?"":"warning"},i.a.createElement(F.a,{type:"text",name:"title",value:this.state.upload.title,onChange:this.onChangeTitle,state:this.state.validation.title?"":"warning",className:"form-field",placeholder:"Sound title",onBlur:this.onFormatTitle,maxLength:"100"})),i.a.createElement(x.a,null,i.a.createElement(F.a,{type:"textarea",name:"desc",onChange:this.onChangeDesc,value:this.state.upload.desc,className:"form-textarea",placeholder:"Sound description",onBlur:this.onFormatDesc})),i.a.createElement(x.a,{className:"form-inline"},i.a.createElement(x.a,{color:this.state.validation.type?"":"warning"},i.a.createElement(F.a,{type:"select",name:"type",value:this.state.upload.type,onChange:this.onChangeType,state:this.state.validation.type?"":"warning",className:"form-field right-space",placeholder:"Sound type..."},i.a.createElement("option",{value:""},"Choose sound type...\xa0\xa0\xa0\xa0"),i.a.createElement("optgroup",{label:"Music"},i.a.createElement("option",{value:"original"},"Original track"),i.a.createElement("option",{value:"cover"},"Cover"),i.a.createElement("option",{value:"remix"},"Remix"),i.a.createElement("option",{value:"mashup"},"Mashup"),i.a.createElement("option",{value:"live"},"Live performance"),i.a.createElement("option",{value:"demo"},"Demo/promo track"),i.a.createElement("option",{value:"djset"},"DJ set")),i.a.createElement("optgroup",{label:"Podcasts & recordings"},i.a.createElement("option",{value:"podcast"},"Podcast show"),i.a.createElement("option",{value:"recording"},"Recording"),i.a.createElement("option",{value:"field"},"Field recording"),i.a.createElement("option",{value:"spoken"},"Spoken track")),i.a.createElement("optgroup",{label:"Samples & others"},i.a.createElement("option",{value:"effect"},"Sound effect"),i.a.createElement("option",{value:"sample"},"One shot sample"),i.a.createElement("option",{value:"loop"},"Loop sample"),i.a.createElement("option",{value:"stem"},"Stem"),i.a.createElement("option",{value:"inprogress"},"Work in progress"),i.a.createElement("option",{value:"other"},"Other")))),i.a.createElement(x.a,{color:this.state.validation.genre?"":"warning"},i.a.createElement(F.a,{type:"text",name:"genre",value:this.state.upload.genre,onChange:this.onChangeGenre,state:this.state.validation.genre?"":"warning",onBlur:this.onFormatGenre,maxLength:"15",className:"form-field right-space",placeholder:"Genre or main tag"})),i.a.createElement(x.a,{className:"wide"},i.a.createElement(F.a,{type:"text",name:"tags",value:this.state.upload.tags,onChange:this.onChangeTags,onBlur:this.onFormatTags,className:"form-field wide",placeholder:"Tags (coma separated)"}))))),i.a.createElement("div",{className:"upload-settings-area"},i.a.createElement(x.a,{className:"wide"},i.a.createElement("label",{className:"switch switch-text switch-pill switch-success"},i.a.createElement("input",{type:"checkbox",id:"sw-dl",checked:this.state.upload.download,onChange:this.onChangeDl,className:"switch-input"}),i.a.createElement("span",{className:"switch-label","data-on":"On","data-off":"Off"}),i.a.createElement("span",{className:"switch-handle"})),i.a.createElement(Et.a,{className:"form-switch-label",htmlFor:"sw-dl"},"Download button"),i.a.createElement("span",{className:"form-note d-md-down-none"},"(Note: all content shared in IPFS is downloadable. This disables the button only.)"),i.a.createElement(F.a,{type:"text",name:"dlgate",value:this.state.upload.dlgate,disabled:!this.state.upload.download,onChange:this.onChangeDlGate,className:"form-field wide",placeholder:"Download gate url (leave empty for direct download from DSound)",onBlur:this.onFormatDlGate})),i.a.createElement(x.a,{className:"wide"},i.a.createElement("label",{className:"switch switch-text switch-pill switch-success"},i.a.createElement("input",{type:"checkbox",id:"sw-buy",checked:this.state.upload.buy,onChange:this.onChangeBuy,className:"switch-input"}),i.a.createElement("span",{className:"switch-label","data-on":"On","data-off":"Off"}),i.a.createElement("span",{className:"switch-handle"})),i.a.createElement(Et.a,{className:"form-switch-label",htmlFor:"sw-buy"},"Buy button"),i.a.createElement("span",{className:"form-note d-md-down-none"},"(Show a 'Buy' button instead.)"),i.a.createElement(F.a,{type:"text",name:"buyurl",value:this.state.upload.buyurl,disabled:!this.state.upload.buy,onChange:this.onChangeBuyUrl,className:"form-field wide",placeholder:"Buy url of your sound on your preferred music store",onBlur:this.onFormatBuyUrl}))),i.a.createElement("div",{className:"sound-uploader-panel",onDragOver:this.onDragOverSound,onDragLeave:this.onDragLeaveSound,onDrop:this.handleSoundFiles},this.getSoundUploader()),i.a.createElement("div",{className:"upload-submit-area"},i.a.createElement("div",{style:{flex:1}}),i.a.createElement(x.a,null,i.a.createElement(S.a,{color:"primary",onClick:this.doSave,className:"form-submit",disabled:!this.state.isDoneSound||!this.state.validation.title||!this.state.validation.type||!this.state.validation.genre||this.state.isPublished},i.a.createElement("i",{className:"fa fa-check-square-o fa-lg"})," Save")," ",i.a.createElement(S.a,{color:"secondary",onClick:this.doCancel,className:"form-cancel"},i.a.createElement("i",{className:"fa fa-close fa-lg"})," Cancel")))))))))}}]),t}(s.Component),St=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).auth=new Y,a.ipfs=new ee.a,a.steem=new z(a.auth,a.ipfs),W.a.setSteem(a.steem),a.soundengine=new Ce({mediaContainer:"#audio-player",normalize:!0}),a.playlist=new je(a.steem,a.ipfs),a.state={songs:null,current:{song:null,playing:!1,pos:0},player:null,feed:null},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"initialize",value:function(e){this.ipfs.initialize(e)}},{key:"componentDidMount",value:function(){var e=this,t=this.auth.getAuthUser();t&&this.steem.getAllUserFollowing(t.name).then(function(t){t.find(function(e){return"dsound"===e.following})||e.steem.followUser("dsound")}).catch(function(e){console.log(e)})}},{key:"getFeedForQuery",value:function(e){var t=this;return function(a){return i.a.createElement(Ie,Object.assign({},a,{auth:t.auth,soundengine:t.soundengine,playlist:t.playlist,query:e}))}}},{key:"getUserFeed",value:function(){var e=this;return function(t){return i.a.createElement(_e,Object.assign({},t,{auth:e.auth,soundengine:e.soundengine,playlist:e.playlist,steem:e.steem}))}}},{key:"getUpload",value:function(){var e=this;return function(t){return i.a.createElement(wt,Object.assign({},t,{auth:e.auth,steem:e.steem,ipfs:e.ipfs,soundengine:e.soundengine}))}}},{key:"getSound",value:function(){var e=this;return function(t){return i.a.createElement(kt,Object.assign({},t,{auth:e.auth,soundengine:e.soundengine,playlist:e.playlist,steem:e.steem}))}}},{key:"getEdit",value:function(){var e=this;return function(t){return i.a.createElement(Nt,Object.assign({},t,{auth:e.auth,steem:e.steem,ipfs:e.ipfs,soundengine:e.soundengine}))}}},{key:"render",value:function(){return i.a.createElement("div",{className:"app"},i.a.createElement(q,Object.assign({},this.props,{auth:this.auth,steem:this.steem,playlist:this.playlist})),i.a.createElement("div",{className:"app-body"},i.a.createElement(H,this.props),i.a.createElement("main",{className:"main"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement(c.a,null,i.a.createElement(u.a,{path:"/@:user/:permlink/trending",render:function(e){return i.a.createElement(g.a,{to:"/trending"})}}),i.a.createElement(u.a,{path:"/@:user/:permlink/hot",render:function(e){return i.a.createElement(g.a,{to:"/hot"})}}),i.a.createElement(u.a,{path:"/@:user/:permlink/new",render:function(e){return i.a.createElement(g.a,{to:"/new"})}}),i.a.createElement(u.a,{path:"/@:user/trending",render:function(e){return i.a.createElement(g.a,{to:"/trending"})}}),i.a.createElement(u.a,{path:"/@:user/hot",render:function(e){return i.a.createElement(g.a,{to:"/hot"})}}),i.a.createElement(u.a,{path:"/@:user/new",render:function(e){return i.a.createElement(g.a,{to:"/new"})}}),i.a.createElement(u.a,{path:"/@:user/:permlink/edit",name:"Edit",component:this.getEdit()}),i.a.createElement(u.a,{path:"/@:user/:permlink",name:"Sound",component:this.getSound()}),i.a.createElement(u.a,{path:"/@:user",name:"User",component:this.getUserFeed()}),i.a.createElement(u.a,{path:"/upload",name:"Upload",component:this.getUpload()}),i.a.createElement(u.a,{path:"/feed",name:"Feed",component:this.getFeedForQuery("feed")}),i.a.createElement(u.a,{path:"/trending",name:"Trending",component:this.getFeedForQuery("trending")}),i.a.createElement(u.a,{path:"/:category/trending",name:"Trending",component:this.getFeedForQuery("trending")}),i.a.createElement(u.a,{path:"/hot",name:"Hot",component:this.getFeedForQuery("hot")}),i.a.createElement(u.a,{path:"/:category/hot",name:"Hot",component:this.getFeedForQuery("hot")}),i.a.createElement(u.a,{path:"/new",name:"New",component:this.getFeedForQuery("new")}),i.a.createElement(u.a,{path:"/:category/new",name:"New",component:this.getFeedForQuery("new")}),i.a.createElement(g.a,{from:"/",to:"/feed"}))))),i.a.createElement("div",{id:"audio-player",style:{display:"none"}}),i.a.createElement($,{auth:this.auth,soundengine:this.soundengine,playlist:this.playlist,current:this.state.current,onStart:this.onPlayerStart}))}}]),t}(s.Component);r.a.render(i.a.createElement(l.a,null,i.a.createElement(c.a,null,i.a.createElement(u.a,{path:"/",name:"Home",component:St}))),document.getElementById("root"))},62:function(e){e.exports={name:"dsound",version:"0.4.3",private:!0,homepage:"/",dsound:{root:"appconfig",link:"https://dsound.io",accounts:{main:"dsound",team:"dsound.team",creator:"prc"},chain:{name:"Hive",website:"https://hive.blog",wallet:"https://wallet.hive.blog",id:"0000000000000000000000000000000000000000000000000000000000000000",prefix:"STM",nodes:["https://anyx.io","https://api.hive.blog","https://api.openhive.network","https://api.hivekings.com"],signup:{name:"hive.io",link:"https://signup.hive.io"}},community:{name:"DSound",hive:"hive-129959",prefix:"hive-"},tags:{main:"dsound",prefix:"dsound-"},fees:{team:500,hive:250,cross:{author:9e3,hive:500}},ipfs:{nodes:[{host:"node01.dsound.audio",port:"",protocol:"https"},{host:"node02.dsound.audio",port:"",protocol:"https"}]}},devDependencies:{concurrently:"^2.0.0","eslint-plugin-flowtype":"^2.35.0","eslint-plugin-import":"^2.7.0","eslint-plugin-jsx-a11y":"^6.0.2","eslint-plugin-react":"^7.3.0",gulp:"^3.9.1","gulp-concat":"^2.6.0","gulp-sass":"^2.3.2","react-scripts":"^2.1.3"},dependencies:{autolinker:"^1.4.3","chart.js":"2.5.0",debounce:"^1.0.2",glamor:"^2.20.40",lodash:"^4.17.4",react:"^16.5.1","react-chartjs-2":"2.1.0","react-dom":"16.5.1","react-router-dom":"4.3.1","react-toastify":"^4.5.2","react-transition-group":"^2.5.3",reactstrap:"^7.1.0",remarkable:"^1.7.1","sanitize-html":"^1.18.2",showdown:"^1.7.6",steem:"^0.6.3",xmldom:"^0.1.27",xss:"^0.3.3"},scripts:{gulp:"gulp",start:"react-scripts start",build:"GENERATE_SOURCEMAP=false react-scripts build",dev:'concurrently "npm run gulp" "npm start" ',test:"react-scripts test --env=jsdom",eject:"react-scripts eject"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"]}}},[[193,2,1]]]);